webpackJsonp([1],{"1HJ4":function(t,e){},"8NFj":function(t,e){},"95RG":function(t,e){},I2ZZ:function(t,e){},IM3k:function(t,e){},J0D7:function(t,e){},Kfxg:function(t,e){},"Kx/P":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={};a.d(i,"postWithToken",function(){return g}),a.d(i,"post",function(){return f}),a.d(i,"getWithToken",function(){return b}),a.d(i,"requestWithToken",function(){return D}),a.d(i,"requestWithoutToken",function(){return y}),a.d(i,"requestWithTokenJson",function(){return _}),a.d(i,"requestWithoutTokenJson",function(){return w}),a.d(i,"getBaseUrl",function(){return k});var n={};a.d(n,"convert",function(){return H});var s=a("lRwf"),o=a.n(s),r=a("NYxO"),l={render:function(){var t=this.$createElement;return(this._self._c||t)("router-view")},staticRenderFns:[]};var c=a("VU/8")({name:"App"},l,!1,function(t){a("V9T7")},null,null).exports,u=a("/ocq"),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hello"},[a("h1",[t._v(t._s(t.msg))]),t._v(" "),a("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),a("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1),t._v(" "),a("el-row",[a("el-button",[t._v("默认按钮")]),t._v(" "),a("el-button",{attrs:{type:"primary"}},[t._v("主要按钮")]),t._v(" "),a("el-button",{attrs:{type:"success"}},[t._v("成功按钮")]),t._v(" "),a("el-button",{attrs:{type:"info"}},[t._v("信息按钮")]),t._v(" "),a("el-button",{attrs:{type:"warning"}},[t._v("警告按钮")]),t._v(" "),a("el-button",{attrs:{type:"danger"}},[t._v("危险按钮")])],1),t._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("备选项")]),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("备选项")])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("\n          Core Docs\n        ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("\n          Forum\n        ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[t._v("\n          Community Chat\n        ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("\n          Twitter\n        ")])]),t._v(" "),a("br"),t._v(" "),a("li",[a("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("\n          Docs for This Template\n        ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n          vue-router\n        ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n          vuex\n        ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n          vue-loader\n        ")])]),this._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n          awesome-vue\n        ")])])])}]};var h=a("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",radio:"1"}}},d,!1,function(t){a("95RG")},"data-v-b14b315c",null).exports,m=a("mtWM"),p=a.n(m),v="";v=window.location.toString().indexOf("47.103.66.70")>-1?"http://47.103.66.70:8081":"http://localhost:8081";var g=function(t,e,a,i){p()({method:"POST",url:v+t,headers:{"Content-type":"application/x-www-form-urlencoded",token:sessionStorage.token},params:e}).then(a).catch(i)},f=function(t,e,a,i){p()({method:"POST",url:v+t,headers:{"Content-type":"application/x-www-form-urlencoded"},params:e}).then(a).catch(i)},b=function(t,e,a,i){p()({method:"GET",url:v+t,headers:{"Content-type":"application/x-www-form-urlencoded"},params:e}).then(a).catch(i)},D=function(t,e,a,i,n){p()({method:e,url:v+t,headers:{"Content-type":"application/x-www-form-urlencoded",token:sessionStorage.token},params:a}).then(i).catch(n)},y=function(t,e,a,i,n){p()({method:e,url:v+t,headers:{"Content-type":"application/x-www-form-urlencoded"},params:a}).then(i).catch(n)},_=function(t,e,a,i,n){p()({method:e,url:v+t,headers:{token:sessionStorage.token},data:a}).then(i).catch(n)},w=function(t,e,a,i,n){p()({method:e,url:v+t,data:a}).then(i).catch(n)},k=function(){return window.location.toString().indexOf("47.103.66.70")>-1?"http://47.103.66.70:8081":"http://localhost:8081"},x=i,C={data:function(){return{logining:!1,ruleForm2:{account:"",checkPass:""},rules2:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],checkPass:[{required:!0,message:"请输入密码",trigger:"blur"}]},checked:!0}},methods:{handleReset2:function(){this.$refs.ruleForm2.resetFields()},handleSubmit2:function(t){var e=this;this.$refs.ruleForm2.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.logining=!0;var a={username:e.ruleForm2.account,password:e.ruleForm2.checkPass};x.requestWithoutToken("/login","post",a,function(t){console.log(t.data),sessionStorage.token=t.data.token,x.requestWithToken("/auth_api/test","get",{},function(t){e.$router.push({path:"/"})},function(t){})},function(t){e.$message({message:"登录失败",type:"error"}),e.logining=!1})})}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%",padding:"0px"},attrs:{id:"login-form-container"}},[a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm login-container",attrs:{model:t.ruleForm2,rules:t.rules2,"label-position":"left","label-width":"60px",id:"login-form"}},[a("h3",{staticClass:"title"},[t._v("系统登录")]),t._v(" "),a("h2",{staticClass:"title1"},[t._v("松墨天牛高效诱捕器管理和数据分析系统")]),t._v(" "),a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:t.ruleForm2.account,callback:function(e){t.$set(t.ruleForm2,"account",e)},expression:"ruleForm2.account"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:t.ruleForm2.checkPass,callback:function(e){t.$set(t.ruleForm2,"checkPass",e)},expression:"ruleForm2.checkPass"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.logining},nativeOn:{click:function(e){return e.preventDefault(),t.handleSubmit2(e)}}},[t._v("登录")])],1),t._v(" "),a("label",{staticClass:"title3"},[t._v("  版权: 福建农林大学，福建辰康农林科技有限公司")])],1)],1)},staticRenderFns:[]};var L=a("VU/8")(C,S,!1,function(t){a("oXj8")},null,null).exports,$={data:function(){return{changePasswordDialog:{visible:!1,orgPassword:"",password:"",rePassword:""},sysName:"VUEADMIN",collapsed:!1,sysUserName:"",sysUserAvatar:"",form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},menus:[]}},methods:{showChangePasswordDialog:function(){this.changePasswordDialog.orgPassword="",this.changePasswordDialog.password="",this.changePasswordDialog.rePassword="",this.changePasswordDialog.visible=!0},handleChangePasswordSubmit:function(){var t=this;x.requestWithToken("/auth_api/user/password","put",{currentPassword:this.changePasswordDialog.orgPassword,newPassword:this.changePasswordDialog.password},function(e){e.data.error&&t.$message.error("修改失败"),e.data.error||(t.$message.success("修改成功"),t.changePasswordDialog.visible=!1)})},onSubmit:function(){console.log("submit!")},handleopen:function(){},handleclose:function(){},handleselect:function(t,e){},logout:function(){var t=this;this.$confirm("确认退出吗?","提示",{}).then(function(){sessionStorage.removeItem("user"),t.$router.push("/login")}).catch(function(){})},collapse:function(){this.collapsed=!this.collapsed},showMenu:function(t,e){this.$refs.menuCollapsed.getElementsByClassName("submenu-hook-"+t)[0].style.display=e?"block":"none"}},mounted:function(){var t=this;sessionStorage.token?x.requestWithToken("/auth_api/user","get",{},function(e){t.$store.state.user=e.data},function(){}):this.$router.push("/login"),x.requestWithToken("/auth_api/menu","get",{},function(e){t.menus=e.data},function(){})}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[a("el-row",[a("el-col",{attrs:{span:1}},[a("div",{staticClass:"tools",on:{click:function(e){return e.preventDefault(),t.collapse(e)}}},[a("i",{staticClass:"fa fa-align-justify"})])]),t._v(" "),a("el-col",{staticClass:"logo",attrs:{span:5}},[t._v("松墨天牛高效诱捕器管理和数据分析系统")])],1)],1),t._v(" "),a("div",{staticClass:"main"},[a("aside",{class:t.collapsed?"menu-collapsed":"menu-expanded"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.$route.path,"unique-opened":"",router:""},on:{open:t.handleopen,close:t.handleclose,select:t.handleselect}},[t._l(t.menus,function(e,i){return[a("el-submenu",{attrs:{index:i}},[a("template",{slot:"title"},[t._v(t._s(e.name))]),t._v(" "),t._l(e.subMenus,function(e){return a("el-menu-item",{key:"/"+e.path,class:t.$route.path==e.path?"is-active":"",attrs:{index:"/"+e.path}},[t._v(t._s(e.name)+"\n            ")])})],2)]}),t._v(" "),a("el-dropdown-item",{nativeOn:{click:function(e){return t.showChangePasswordDialog(e)}}},[t._v("修改密码")]),t._v(" "),a("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(e){return t.logout(e)}}},[t._v("退出登录")])],2)],1),t._v(" "),a("div",{staticClass:"content-container"},[a("div",{staticStyle:{height:"40px","padding-left":"20px","font-size":"20px"}},[t._v("\n        "+t._s(t.$route.name)+"\n      ")]),t._v(" "),a("div",{staticClass:"content-wrapper"},[a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("router-view")],1)],1)])]),t._v(" "),a("el-dialog",{attrs:{visible:t.changePasswordDialog.visible,title:"修改密码",width:"25%"},on:{"update:visible":function(e){t.$set(t.changePasswordDialog,"visible",e)}}},[a("el-form",[a("el-form-item",{attrs:{label:"原密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.changePasswordDialog.orgPassword,callback:function(e){t.$set(t.changePasswordDialog,"orgPassword",e)},expression:"changePasswordDialog.orgPassword"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.changePasswordDialog.password,callback:function(e){t.$set(t.changePasswordDialog,"password",e)},expression:"changePasswordDialog.password"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.changePasswordDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleChangePasswordSubmit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var T=a("VU/8")($,M,!1,function(t){a("IM3k")},"data-v-be503484",null).exports,I={name:"UserMgr",data:function(){var t=this;return{labelposition:"left",searchText:"",userTypes:[{label:"超级用户",value:"0"},{label:"省级用户",value:"1"},{label:"市级用户",value:"2"},{label:"县级用户",value:"3"},{label:"管理员",value:"4"},{label:"工人",value:"5"}],roleType:"",activeType:"",userData:{list:[],page:1,limit:10,total:0,selectedIndex:-1},userInfoDialog:{isAdd:!0,title:"",visible:!1,form:{username:"",password:"",provinceCode:"",areaCode:"",cityCode:""},provinces:[],cities:[],areas:[],rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],repeat_password:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:function(e,a,i){if(a!=t.userInfoDialog.form.password)return i(new Error("两次输入的密码不一致"));i()}}],role:[{required:!0,message:"请选择角色",trigger:"blur"}],provinceCode:[{required:!0,message:"请选择省",trigger:"blur"}],cityCode:[{required:!0,message:"请选择市",trigger:"blur"}],areaCode:[{required:!0,message:"请选择县",trigger:"blur"}]}}}},methods:{handleRestPassword:function(){var t=this,e=this.userData.list[this.userData.selectedIndex].username;x.requestWithToken("/auth_api/user/reset_password","post",{targetUsername:e},function(e){e.data.error||t.$message.success("重置密码成功"),e.data.error&&t.$message.error("重置密码失败")})},handleUserDataSubmit:function(){var t=this;if(this.userInfoDialog.isAdd){var e=this.userInfoDialog.form;switch(this.userInfoDialog.form.role){case 1:e.adcode=e.provinceCode;break;case 2:e.adcode=e.cityCode;break;case 3:case 4:case 5:e.adcode=e.areaCode}this.$refs.userInfoDialogForm.validate(function(a){a&&x.requestWithTokenJson("/auth_api/user","post",e,function(e){e.data.error?t.$message({message:e.data.message,type:"error"}):(t.$message({message:"添加成功",type:"success"}),t.userInfoDialog.visible=!0,t.loadUser())},function(){})})}else this.handleUserEdit()},handleUserDelete:function(){var t=this,e=this.userData.list[this.userData.selectedIndex].username;x.requestWithToken("/auth_api/user_forbid","put",{targetUser:e},function(e){e.data.error?t.$message({message:"删除失败",type:"error"}):(t.$message({message:"删除成功",type:"success"}),t.loadUser())},function(){})},loadUserActive:function(){var t=this;"6"==this.roleType&&(this.roleType=""),"2"==this.activeType&&(this.activeType=""),x.requestWithToken("/auth_api/user_list_active","get",{searchText:this.searchText,limit:this.userData.limit,page:this.userData.page,roleType:this.roleType,active:this.activeType},function(e){t.userData.list=e.data.data,t.userData.page=e.data.currentPage,t.userData.total=e.data.totalNum,t.userData.selectedIndex=-1},function(){})},handleUserEdit:function(){var t=this;x.requestWithTokenJson("/auth_api/user","put",this.userInfoDialog.form,function(e){e.data.error?t.$message({message:"修改失败",type:"error"}):(t.$message({message:"修改成功",type:"success"}),t.userInfoDialog.visible=!1,t.loadUser())},function(){})},loadUser:function(){var t=this;"6"==this.roleType&&(this.roleType=""),"2"==this.activeType&&(this.activeType=""),x.requestWithToken("/auth_api/user_list","get",{searchText:this.searchText,limit:this.userData.limit,page:this.userData.page,roleType:this.roleType,active:this.activeType},function(e){t.userData.list=e.data.data,t.userData.page=e.data.currentPage,t.userData.total=e.data.totalNum,t.userData.selectedIndex=-1},function(){})},handleUserDataCurrentPageChanged:function(t){this.userData.page=t,this.loadUser()},showAddUser:function(){this.userInfoDialog.isAdd=!0,this.userInfoDialog.visible=!0,this.userInfoDialog.form={province:"",area:"",city:"",active:!0},this.loadProvince()},showEditUser:function(){this.userInfoDialog.isAdd=!1,this.userInfoDialog.visible=!0,this.userInfoDialog.form={username:this.userData.list[this.userData.selectedIndex].username,name:this.userData.list[this.userData.selectedIndex].name,active:this.userData.list[this.userData.selectedIndex].active,phone:this.userData.list[this.userData.selectedIndex].phone,email:this.userData.list[this.userData.selectedIndex].email},this.loadProvince()},loadProvince:function(){var t=this;x.requestWithToken("/auth_api/dist/provinces","get",{},function(e){console.log(e.data),t.userInfoDialog.provinces=e.data,t.userInfoDialog.form.province="",t.userInfoDialog.form.city="",t.userInfoDialog.form.area="",t.userInfoDialog.cities=[],t.userInfoDialog.areas=[]},function(){})},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.userInfoDialog.form.provinceCode},function(e){t.userInfoDialog.cities=e.data,t.userInfoDialog.form.city="",t.userInfoDialog.form.area="",t.userInfoDialog.areas=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.userInfoDialog.form.cityCode},function(e){t.userInfoDialog.form.area="",t.userInfoDialog.areas=e.data},function(){})}},mounted:function(){this.loadUser()}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div",[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"用户名/姓名/地区"},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"用户类型"},model:{value:t.roleType,callback:function(e){t.roleType=e},expression:"roleType"}},[a("el-option",{attrs:{value:"6",label:"全部"}},[t._v("全部")]),t._v(" "),0==this.$store.state.user.role?a("el-option",{attrs:{value:1,label:"省级用户"}},[t._v("省级用户")]):t._e(),t._v(" "),0==this.$store.state.user.role?a("el-option",{key:2,attrs:{value:2,label:"市级用户"}},[t._v("市级用户")]):t._e(),t._v(" "),0==this.$store.state.user.role?a("el-option",{key:3,attrs:{value:3,label:"县级用户"}},[t._v("县级用户")]):t._e(),t._v(" "),3==this.$store.state.user.role||0==this.$store.state.user.role?a("el-option",{key:4,attrs:{value:4,label:"管理员"}},[t._v("管理员")]):t._e(),t._v(" "),4==this.$store.state.user.role||0==this.$store.state.user.role?a("el-option",{key:5,attrs:{value:5,label:"工人"}},[t._v("工人")]):t._e()],1),t._v(" "),a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"激活状态"},model:{value:t.activeType,callback:function(e){t.activeType=e},expression:"activeType"}},[a("el-option",{attrs:{value:"2",label:"全部"}},[t._v("全部")]),t._v(" "),a("el-option",{attrs:{value:"1",label:"是"}},[t._v("是")]),t._v(" "),a("el-option",{attrs:{value:"0",label:"否"}},[t._v("否")])],1),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.loadUser}},[t._v("搜索")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.showAddUser}},[t._v("添加")]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:-1==t.userData.selectedIndex},on:{click:t.showEditUser}},[t._v("修改")]),t._v(" "),6==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:t.handleUserDelete}},[t._v("删除")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:-1==t.userData.selectedIndex},on:{click:function(e){t.handleRestPassword()}}},[t._v("重置密码")])],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.userData.list,height:"600"}},[a("el-table-column",{attrs:{label:"",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio",{attrs:{label:e.$index},nativeOn:{change:function(a){t.getCurrentRow(e.$index)}},model:{value:t.userData.selectedIndex,callback:function(e){t.$set(t.userData,"selectedIndex",e)},expression:"userData.selectedIndex"}},[t._v(" ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.userTypes[e.row.role].label))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"province",label:"省份",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"city",label:"市区",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area",label:"县",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"激活状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(1==e.row.active?"激活":"禁用"))]}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.userData.page,"page-size":10,layout:"total, prev, pager, next",total:t.userData.total},on:{"current-change":t.handleUserDataCurrentPageChanged,"update:currentPage":function(e){t.$set(t.userData,"page",e)}}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.userInfoDialog.isAdd?"添加用户":"编辑用户",visible:t.userInfoDialog.visible},on:{"update:visible":function(e){t.$set(t.userInfoDialog,"visible",e)}}},[a("el-form",{ref:"userInfoDialogForm",attrs:{model:t.userInfoDialog.form,"label-position":t.labelposition,rules:t.userInfoDialog.rules}},[a("div",{attrs:{id:"userInfoDialogData"}},[a("div",[t.userInfoDialog.isAdd?a("el-form-item",{attrs:{label:"用户名","label-width":"80px",size:"mini",prop:"username"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{autocomplete:"off"},model:{value:t.userInfoDialog.form.username,callback:function(e){t.$set(t.userInfoDialog.form,"username",e)},expression:"userInfoDialog.form.username"}})],1):t._e(),t._v(" "),t.userInfoDialog.isAdd?a("el-form-item",{attrs:{label:"密码","label-width":"80px",size:"mini",prop:"password"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"auto-complete":"off",type:"password"},model:{value:t.userInfoDialog.form.password,callback:function(e){t.$set(t.userInfoDialog.form,"password",e)},expression:"userInfoDialog.form.password"}})],1):t._e(),t._v(" "),t.userInfoDialog.isAdd?a("el-form-item",{attrs:{label:"重复密码","label-width":"80px",size:"mini",prop:"repeat_password"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"auto-complete":"off",type:"password"},model:{value:t.userInfoDialog.form.repeat_password,callback:function(e){t.$set(t.userInfoDialog.form,"repeat_password",e)},expression:"userInfoDialog.form.repeat_password"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":"80px",size:"mini",prop:"name"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"auto-complete":"off"},model:{value:t.userInfoDialog.form.name,callback:function(e){t.$set(t.userInfoDialog.form,"name",e)},expression:"userInfoDialog.form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮箱","label-width":"80px",size:"mini",prop:"email"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"auto-complete":"off"},model:{value:t.userInfoDialog.form.email,callback:function(e){t.$set(t.userInfoDialog.form,"email",e)},expression:"userInfoDialog.form.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"手机","label-width":"80px",size:"mini",prop:"phone"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"auto-complete":"off"},model:{value:t.userInfoDialog.form.phone,callback:function(e){t.$set(t.userInfoDialog.form,"phone",e)},expression:"userInfoDialog.form.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"激活","label-width":"80px",size:"mini",prop:"active"}},[a("el-checkbox",{attrs:{name:"active"},model:{value:t.userInfoDialog.form.active,callback:function(e){t.$set(t.userInfoDialog.form,"active",e)},expression:"userInfoDialog.form.active"}})],1)],1),t._v(" "),t.userInfoDialog.isAdd?a("div",[a("el-form-item",{attrs:{label:"角色",size:"mini","label-width":"80px",prop:"role"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"用户类型"},model:{value:t.userInfoDialog.form.role,callback:function(e){t.$set(t.userInfoDialog.form,"role",e)},expression:"userInfoDialog.form.role"}},[0==this.$store.state.user.role?a("el-option",{key:1,attrs:{value:1,label:"省级用户"}},[t._v("省级用户")]):t._e(),t._v(" "),0==this.$store.state.user.role?a("el-option",{key:2,attrs:{value:2,label:"市级用户"}},[t._v("市级用户")]):t._e(),t._v(" "),0==this.$store.state.user.role?a("el-option",{key:3,attrs:{value:3,label:"县级用户"}},[t._v("县级用户")]):t._e(),t._v(" "),3==this.$store.state.user.role||0==this.$store.state.user.role?a("el-option",{key:4,attrs:{value:4,label:"管理员"}},[t._v("管理员")]):t._e(),t._v(" "),4==this.$store.state.user.role?a("el-option",{key:5,attrs:{value:5,label:"工人"}},[t._v("工人")]):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"省","label-width":"80px",size:"mini",prop:"provinceCode"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"省份"},on:{change:t.loadCity},model:{value:t.userInfoDialog.form.provinceCode,callback:function(e){t.$set(t.userInfoDialog.form,"provinceCode",e)},expression:"userInfoDialog.form.provinceCode"}},t._l(t.userInfoDialog.provinces,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1),t._v(" "),t.userInfoDialog.form.role>1?a("el-form-item",{attrs:{label:"市","label-width":"80px",size:"mini",prop:"cityCode"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"市"},on:{change:t.loadArea},model:{value:t.userInfoDialog.form.cityCode,callback:function(e){t.$set(t.userInfoDialog.form,"cityCode",e)},expression:"userInfoDialog.form.cityCode"}},t._l(t.userInfoDialog.cities,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1):t._e(),t._v(" "),t.userInfoDialog.form.role>2?a("el-form-item",{attrs:{label:"县","label-width":"80px",size:"mini",prop:"areaCode"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"县"},model:{value:t.userInfoDialog.form.areaCode,callback:function(e){t.$set(t.userInfoDialog.form,"areaCode",e)},expression:"userInfoDialog.form.areaCode"}},t._l(t.userInfoDialog.areas,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1):t._e()],1):t._e()])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.userInfoDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleUserDataSubmit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var W=a("VU/8")(I,A,!1,function(t){a("J0D7")},null,null).exports,q=a("bOdI"),R=a.n(q),E=a("Pg0u"),P=a.n(E),Q={data:function(){var t;return t={showCity:!0,showArea:!0,provincesname:[],provincename:"",cityname:"",areaname:"",citiesname:[],areasname:[],provinces:[],province:""},R()(t,"provincename",""),R()(t,"cities",[]),R()(t,"city",""),R()(t,"areas",[]),R()(t,"area",""),R()(t,"towns",[]),R()(t,"town",""),R()(t,"managers",[]),R()(t,"manager",""),R()(t,"startDate",""),R()(t,"endDate",""),R()(t,"contentLabelDict",["市","县","乡镇","工人"]),R()(t,"contentLabelIndex",0),R()(t,"myarea",""),R()(t,"summaryList",[]),R()(t,"analysisList",[]),R()(t,"mcList",[]),R()(t,"tabPage","first"),R()(t,"mcType","0"),R()(t,"startYear",""),R()(t,"endYear",""),t},methods:{init:function(){this.showCity=!0,this.showArea=!0;var t=this.$store.state.user.role;1==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.loadCity()):2==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.loadArea()):3==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.loadManagers()):4==t&&(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.manager=this.$store.state.user.username)},query:function(){this.tabPage="first";var t=this.$store.state.user.role;4==t&&this.queryWorkerData(),3==t&&(""==this.manager?this.queryTownData():this.queryWorkerData()),2==t&&(""==this.area&&""==this.manager&&this.queryAreaData(),""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.area&&""!=this.manager&&this.queryWorkerData()),1==t&&(""==this.city&&this.queryCityData(),""!=this.city&&""==this.area&&this.queryAreaData(),""!=this.city&&""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.city&&""!=this.area&&""!=this.manager&&this.queryWorkerData())},queryWorkerData:function(){var t=this;this.contentLabelIndex=3,null!=this.$store.state.user.town?this.provincename=this.$store.state.user.town:null==this.$store.state.user.town&&null!=this.$store.state.user.area?this.provincename=this.$store.state.user.area:null==this.$store.state.user.area&&null!=this.$store.state.user.city?this.provincename=this.$store.state.user.city:null==this.$store.state.user.city&&null!=this.$store.state.user.province?this.provincename=this.$store.state.user.province:this.provincename="",x.requestWithToken("/auth_api/monthSummary/worker","get",{adcode:this.manager,startYear:this.startYear,endYear:this.endYear},function(e){e.data.error?(t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):t.summaryList=e.data.data,t.drawChart()},function(){})},queryTownData:function(){var t=this;this.contentLabelIndex=2,this.myarea=this.area,x.requestWithToken("/auth_api/user/provinceName","get",{adcode:this.myarea},function(e){e.data.error?t.$message({message:"失败",type:"error"}):(t.provincesname=e.data.data,t.provincename=t.provincesname[2]),t.drawChart()},function(){}),x.requestWithToken("/auth_api/monthSummary/town","get",{adcode:this.area,startYear:this.startYear,endYear:this.endYear},function(e){e.data.error?(t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):t.summaryList=e.data.data,t.drawChart()},function(){})},queryAreaData:function(){var t=this;this.contentLabelIndex=1,this.myarea=this.city,x.requestWithToken("/auth_api/user/provinceName","get",{adcode:this.myarea},function(e){e.data.error?t.$message({message:"失败",type:"error"}):(t.provincesname=e.data.data,t.provincename=t.provincesname[1]),t.drawChart()},function(){}),x.requestWithToken("/auth_api/monthSummary/area","get",{adcode:this.city,startYear:this.startYear,endYear:this.endYear},function(e){e.data.error?(t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):t.summaryList=e.data.data,t.drawChart()},function(){})},queryCityData:function(){var t=this;this.contentLabelIndex=0,this.myarea=this.province,x.requestWithToken("/auth_api/user/provinceName","get",{adcode:this.myarea},function(e){e.data.error?t.$message({message:"失败",type:"error"}):(t.provincesname=e.data.data,t.provincename=t.provincesname[0]),t.drawChart()},function(){}),x.requestWithToken("/auth_api/monthSummary/city","get",{adcode:this.province,startYear:this.startYear,endYear:this.endYear},function(e){e.data.error?(t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):t.summaryList=e.data.data,t.drawChart()},function(){})},drawChart:function(){var t=P.a.init(this.$refs.echartsArea),e=[],a=[];if(0==this.summaryList.length)t.clear();else{4==this.$store.state.user.role&&(this.provincename=this.$store.state.user.username);for(var i=0;i<this.summaryList.length;++i)e.push(this.summaryList[i].month+"月"),a.push(this.summaryList[i].num);var n={toolbox:{show:!0,feature:{saveAsImage:{show:!0,excludeComponents:["toolbox"],pixelRatio:2}}},tooltip:{show:!1},xAxis:{name:this.provincename+"松墨天牛数量时间动态图",nameLocation:"center",nameTextStyle:{padding:[20,0,0,0]},data:e},yAxis:{name:"松墨天牛数量",nameLocation:"center",nameTextStyle:{padding:[0,0,20,0]}},series:[{name:"数量",type:"bar",data:a,itemStyle:{normal:{color:"#77bef7",label:{show:!0,textStyle:{fontWeight:"bolder",fontSize:"12",fontFamily:"微软雅黑"}}}}}]};t.setOption(n)}},makeAnalysisData:function(t){console.log(t);var e=[];e.push({0:this.contentLabelDict[this.contentLabelIndex]+"间",1:t.ssa,2:t.dfa,3:t.msa,4:t.f,5:t.fcrit,6:t.r}),e.push({0:this.contentLabelDict[this.contentLabelIndex]+"内",1:t.sse,2:t.dfe,3:t.mse,4:"",5:"",6:""}),e.push({0:"总计",1:t.sst,2:t.dft,3:"",4:"",5:"",6:""}),this.analysisList=e,console.log(this.analysisList)},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.province},function(e){t.cities=e.data,t.city="",t.area="",t.areas=[],t.citiesname=e.data,t.cityname="",t.areaname="",t.areasname=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.city},function(e){t.area="",t.areas=e.data},function(){})},loadManagers:function(){var t=this;x.requestWithToken("/auth_api/manager_list","get",{adcode:this.area},function(e){t.managers=e.data.data,console.log(t.managers)},function(){})},areaChanged:function(){this.manager="",this.loadManagers()},cityChanged:function(){this.area="",this.manager="",this.loadArea()},tableRowStyle:function(t){t.row,t.rowIndex;return"border: 0;border-top-color:white;"},tableHeaderColor:function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;if(0===e)return"background-color: lightblue;color: #fff;font-weight: 500;"}},mounted:function(){this.init()}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[this.$store.state.user.role<2&&t.showCity?a("el-select",{attrs:{placeholder:"市"},on:{change:t.cityChanged},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.cities,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),this.$store.state.user.role<3&&t.showArea?a("el-select",{attrs:{placeholder:"县"},on:{change:function(e){t.areaChanged()}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.areas,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.startYear,callback:function(e){t.startYear=e},expression:"startYear"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.endYear,callback:function(e){t.endYear=e},expression:"endYear"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.query()}}},[t._v("查询")]),t._v(" "),a("el-card",{staticStyle:{padding:"5px"}},[a("div",{ref:"echartsArea",staticStyle:{width:"100%",height:"300px"}})])],1)},staticRenderFns:[]};var U=a("VU/8")(Q,B,!1,function(t){a("1HJ4")},null,null).exports;var F=3.141592653589793,V=6378245,N=.006693421622965943,O=52.35987755982988;function z(t,e){var a=function(t,e){var a=function(t,e){var a=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))/3,a+=2*(20*Math.sin(e*F)+40*Math.sin(e/3*F))/3,a+=2*(160*Math.sin(e/12*F)+320*Math.sin(e*F/30))/3}(e-105,t-35),i=function(t,e){var a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=2*(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))/3,a+=2*(20*Math.sin(t*F)+40*Math.sin(t/3*F))/3,a+=2*(150*Math.sin(t/12*F)+300*Math.sin(t/30*F))/3}(e-105,t-35),n=t/180*F,s=Math.sin(n);s=1-N*s*s;var o=Math.sqrt(s);a=180*a/(V*(1-N)/(s*o)*F),i=180*i/(V/o*Math.cos(n)*F);var r=t+a,l=e+i,c=[];return c.push(r),c.push(l),c}(t,e);return function(t,e){var a=e,i=t,n=Math.sqrt(a*a+i*i)+2e-5*Math.sin(i*O),s=Math.atan2(i,a)+3e-6*Math.cos(a*O),o=n*Math.cos(s)+.0065,r=n*Math.sin(s)+.006,l=[];return l.push(r),l.push(o),l}(a[0],a[1])}var H=function(t,e){return z(t,e)},j=n,Y={data:function(){return{showCity:!0,showArea:!0,provinces:[],province:"",cities:[],city:"",areas:[],area:"",towns:[],town:"",managers:[],manager:"",startDate:"",endDate:"",contentLabelDict:["市","县","乡镇","工人"],contentLabelIndex:0,summaryList:[],analysisList:[],mcList:[],tabPage:"first",mcType:"0"}},methods:{init:function(){this.showCity=!0,this.showArea=!0;var t=this.$store.state.user.role;1==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.loadCity()):2==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.loadArea()):3==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.loadManagers()):4==t&&(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.manager=this.$store.state.user.username)},exportExcel:function(){var t=this.$store.state.user.role;4==t&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token),3==t&&(""==this.manager?window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token:window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token),2==t&&(""==this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.city+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=1&token="+sessionStorage.token),""!=this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token),""!=this.area&&""!=this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token)),1==t&&(""==this.city&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.province+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=0&token="+sessionStorage.token),""!=this.city&&""==this.area&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.city+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=1&token="+sessionStorage.token),""!=this.city&&""!=this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token),""!=this.city&&""!=this.area&&""!=this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token))},query:function(){this.tabPage="first";var t=this.$store.state.user.role;4==t&&this.queryWorkerData(),3==t&&(""==this.manager?this.queryTownData():this.queryWorkerData()),2==t&&(""==this.area&&""==this.manager&&this.queryAreaData(),""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.area&&""!=this.manager&&this.queryWorkerData()),1==t&&(""==this.city&&this.queryCityData(),""!=this.city&&""==this.area&&this.queryAreaData(),""!=this.city&&""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.city&&""!=this.area&&""!=this.manager&&this.queryWorkerData())},queryWorkerData:function(){var t=this;this.contentLabelIndex=3,x.requestWithToken("/auth_api/statistics/worker","get",{manager:this.manager,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryTownData:function(){var t=this;this.contentLabelIndex=2,x.requestWithToken("/auth_api/statistics/town","get",{adcode:this.area,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryAreaData:function(){var t=this;this.contentLabelIndex=1,x.requestWithToken("/auth_api/statistics/area","get",{adcode:this.city,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryCityData:function(){var t=this;this.contentLabelIndex=0,x.requestWithToken("/auth_api/statistics/city","get",{adcode:this.province,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},drawChart:function(){var t=P.a.init(this.$refs.echartsArea),e=[],a=[],i=[];if(0==this.summaryList.length)t.clear();else{for(var n=0;n<this.summaryList.length;++n)e.push(this.summaryList[n].name),a.push(this.summaryList[n].mean),i.push([n,this.summaryList[n].mean-this.summaryList[n].std,this.summaryList[n].mean+this.summaryList[n].std]);var s={toolbox:{show:!0,feature:{saveAsImage:{show:!0,excludeComponents:["toolbox"],pixelRatio:2}}},title:{text:"统计分析图",x:"center",y:"top",textAlign:"center"},tooltip:{show:!1},xAxis:{name:this.contentLabelDict[this.contentLabelIndex],nameLocation:"center",nameTextStyle:{padding:[20,0,0,0]},data:e},yAxis:{name:"诱虫量",nameLocation:"center",nameTextStyle:{padding:[0,0,20,0]}},series:[{name:"均值",type:"bar",data:a,itemStyle:{normal:{color:"#77bef7"}}},{type:"custom",name:"标准差",itemStyle:{normal:{borderWidth:1.5,color:"#000000"}},renderItem:function(t,e){var a=e.value(0),i=e.coord([a,e.value(1)]),n=e.coord([a,e.value(2)]),s=(e.size([1,0])[0],e.style({stroke:e.visual("color"),fill:null}));return{type:"group",children:[{type:"line",shape:{x1:i[0]-5,y1:i[1],x2:i[0]+5,y2:i[1]},style:s},{type:"line",shape:{x1:i[0],y1:i[1],x2:n[0],y2:n[1]},style:s},{type:"line",shape:{x1:n[0]-5,y1:n[1],x2:n[0]+5,y2:n[1]},style:s}]}},encode:{x:0,y:[1,2]},data:i,z:100}]};t.setOption(s)}},makeAnalysisData:function(t){console.log(t);var e=[];e.push({0:this.contentLabelDict[this.contentLabelIndex]+"间",1:t.ssa,2:t.dfa,3:t.msa,4:t.f,5:t.fcrit,6:t.r}),e.push({0:this.contentLabelDict[this.contentLabelIndex]+"内",1:t.sse,2:t.dfe,3:t.mse,4:"",5:"",6:""}),e.push({0:"总计",1:t.sst,2:t.dft,3:"",4:"",5:"",6:""}),this.analysisList=e,console.log(this.analysisList)},loadProvince:function(){var t=this;x.requestWithToken("/auth_api/dist/provinces","get",{},function(e){console.log(e.data),t.provinces=e.data,t.province="",t.city="",t.area="",t.cities=[],t.areas=[]},function(){})},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.province},function(e){t.cities=e.data,t.city="",t.area="",t.areas=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.city},function(e){t.area="",t.areas=e.data},function(){})},loadManagers:function(){var t=this;x.requestWithToken("/auth_api/manager_list","get",{adcode:this.area},function(e){t.managers=e.data.data,console.log(t.managers)},function(){})},areaChanged:function(){this.manager="",this.loadManagers()},cityChanged:function(){this.area="",this.manager="",this.loadArea()},tableRowStyle:function(t){t.row,t.rowIndex;return"border: 0;border-top-color:white;"},tableHeaderColor:function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;if(0===e)return"background-color: lightblue;color: #fff;font-weight: 500;"}},mounted:function(){this.init()}},J={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[this.$store.state.user.role<2&&t.showCity?a("el-select",{attrs:{placeholder:"市"},on:{change:t.cityChanged},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.cities,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),this.$store.state.user.role<3&&t.showArea?a("el-select",{attrs:{placeholder:"县"},on:{change:function(e){t.areaChanged()}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.areas,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.query()}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportExcel()}}},[t._v("保存表格")])],1),t._v(" "),a("el-tabs",{attrs:{id:"statistics-tabs",type:"card"},model:{value:t.tabPage,callback:function(e){t.tabPage=e},expression:"tabPage"}},[a("el-tab-pane",{attrs:{label:"描述性统计分析",name:"first"}},[a("el-card",{staticStyle:{padding:"5px"},attrs:{header:"描述性统计分析表"}},[a("el-table",{attrs:{data:t.summaryList,"row-style":t.tableRowStyle}},[a("el-table-column",{attrs:{label:t.contentLabelDict[t.contentLabelIndex],prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"诱捕器数量",prop:"count"}}),t._v(" "),a("el-table-column",{attrs:{label:"总诱虫量",prop:"sum"}}),t._v(" "),a("el-table-column",{attrs:{label:"平均",prop:"mean"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准差",prop:"std"}}),t._v(" "),a("el-table-column",{attrs:{label:"最大值",prop:"max"}}),t._v(" "),a("el-table-column",{attrs:{label:"最小值",prop:"min"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信区间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.confidenceLo+"~"+e.row.confidenceHi))]}}])})],1)],1),t._v(" "),a("el-card",{staticStyle:{padding:"5px"}},[a("div",{ref:"echartsArea",staticStyle:{width:"100%",height:"300px"}})])],1),t._v(" "),a("el-tab-pane",{attrs:{label:"方差分析",name:"second"}},[a("el-card",[a("el-table",{attrs:{data:t.analysisList}},[a("el-table-column",{attrs:{label:"差异源",prop:"0"}}),t._v(" "),a("el-table-column",{attrs:{label:"平方和SS",prop:"1"}}),t._v(" "),a("el-table-column",{attrs:{label:"自由度DF",prop:"2"}}),t._v(" "),a("el-table-column",{attrs:{label:"方差MS",prop:"3"}}),t._v(" "),a("el-table-column",{attrs:{label:"统计量F",prop:"4"}}),t._v(" "),a("el-table-column",{attrs:{label:"临界值F crit",prop:"5"}}),t._v(" "),a("el-table-column",{attrs:{label:"相关系数R",prop:"6"}})],1),t._v(" "),a("label",[t._v("备注：当统计量F>临界值F时，方差分析达到显著差异")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"多重比较",name:"third"}},[a("el-card",{staticStyle:{width:"100%",padding:"5px"},attrs:{header:"差异性分析"}},[a("el-select",{model:{value:t.mcType,callback:function(e){t.mcType=e},expression:"mcType"}},[a("el-option",{key:"LSD",attrs:{value:"0",label:"LSD"}},[t._v("LSD")]),t._v(" "),a("el-option",{key:"SCHEFFE",attrs:{value:"1",label:"SCHEFFE"}},[t._v("SCHEFFE")])],1),t._v(" "),0==t.mcType?a("el-table",{attrs:{data:t.mcList}},[a("el-table-column",{attrs:{label:"(i)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelA"}}),t._v(" "),a("el-table-column",{attrs:{label:"(j)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelB"}}),t._v(" "),a("el-table-column",{attrs:{label:"均值差值",prop:"dv"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准误",prop:"standardError"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信下限",prop:"lsdConfidenceLo"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信上限",prop:"lsdConfidenceHi"}}),t._v(" "),a("el-table-column",{attrs:{label:"LSD值",prop:"lsd"}}),t._v(" "),a("el-table-column",{attrs:{label:"差异显著"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.lsdSignificance?"是":"否"))]}}])})],1):t._e(),t._v(" "),1==t.mcType?a("el-table",{attrs:{data:t.mcList}},[a("el-table-column",{attrs:{label:"(i)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelA"}}),t._v(" "),a("el-table-column",{attrs:{label:"(j)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelB"}}),t._v(" "),a("el-table-column",{attrs:{label:"均值差值",prop:"dv"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准误",prop:"standardError"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信下限",prop:"scheffeConfidenceLo"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信上限",prop:"scheffeConfidenceHi"}}),t._v(" "),a("el-table-column",{attrs:{label:"D值",prop:"scheffe"}}),t._v(" "),a("el-table-column",{attrs:{label:"差异显著"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.scheffeSignificance?"是":"否"))]}}])})],1):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var G=a("VU/8")(Y,J,!1,function(t){a("j998")},null,null).exports,Z={components:{"t-statistics-view":G},data:function(){return{map:void 0,dialogVisible:!1}},methods:{loadSpots:function(t){var e=this;this.map.clearOverlays(),"device"==t&&x.requestWithToken("/auth_api/device_list","get",{page:1,limit:1e3},function(t){console.log(t.data);var a=e;function i(t,e){var i=new BMap.Marker(t);a.map.addOverlay(i)}function n(t,e){var i={position:e,offset:new BMap.Size(5,-5)},n=new BMap.Label(t,i);n.setStyle({color:"black",fontSize:"12px",height:"20px",lineHeight:"20px",fontFamily:"微软雅黑"}),a.map.addOverlay(n)}for(var s=t.data.data,o=0;o<s.length;++o)if(s[o].longitude&&s[o].latitude){var r=j.convert(s[o].latitude,s[o].longitude);i(r=new BMap.Point(r[1],r[0])),n(s[o].id,r);var l="";null!=s[o].town&&(l=s[o].town+l),null!=s[o].city&&(l=s[o].city+l),null!=s[o].area&&(l=s[o].area+l),null!=s[o].province&&(l=s[o].province+l),l&&e.map.centerAndZoom(l,5)}},function(){}),"device"!=t&&x.requestWithTokenJson("/auth_api/statistics_map/"+t+"_spots","get",{},function(a){console.log(a.data);var i=e;for(var n=a.data,s=function(a){if(n[a].longitude&&n[a].latitude){r=j.convert(n[a].latitude,n[a].longitude),function(t,e){var a=new BMap.Marker(t);a.addEventListener("click",e),i.map.addOverlay(a)}(r=new BMap.Point(r[1],r[0]),function(){"province"==t?(e.dialogVisible=!0,setTimeout(function(){e.$nextTick(function(){e.$refs.statisticsView.startDate="",e.$refs.statisticsView.endDate="",e.$refs.statisticsView.city="",e.$refs.statisticsView.area="",e.$refs.statisticsView.query()})},10)):"city"==t?(e.dialogVisible=!0,setTimeout(function(){e.$nextTick(function(){e.$refs.statisticsView.startDate="",e.$refs.statisticsView.endDate="",e.$refs.statisticsView.area="",e.$refs.statisticsView.showCity=!1,e.$refs.statisticsView.city=n[a].adcode.substring(0,4),e.$refs.statisticsView.query(),e.$refs.statisticsView.cityChanged()})},10)):"area"==t&&(e.dialogVisible=!0,setTimeout(function(){e.$nextTick(function(){e.$refs.statisticsView.startDate="",e.$refs.statisticsView.endDate="",e.$refs.statisticsView.town="",e.$refs.statisticsView.showCity=!1,e.$refs.statisticsView.showArea=!1,e.$refs.statisticsView.city=n[a].adcode.substring(0,4),e.$refs.statisticsView.area=n[a].adcode,e.$refs.statisticsView.query(),e.$refs.statisticsView.areaChanged(),e.$refs.statisticsView.area=n[a].adcode})},10))}),function(t,e){var a={position:e,offset:new BMap.Size(5,-5)},n=new BMap.Label(t,a);n.setStyle({color:"black",fontSize:"12px",height:"20px",lineHeight:"20px",fontFamily:"微软雅黑"}),i.map.addOverlay(n)}(n[a][t],r);var s="";null!=n[a].town&&(s=n[a].town+s),null!=n[a].city&&(s=n[a].city+s),null!=n[a].area&&(s=n[a].area+s),null!=n[a].province&&(s=n[a].province+s),s&&e.map.centerAndZoom(s,5)}},o=0;o<n.length;++o){var r;s(o)}},function(){})}},mounted:function(){this.map=new BMap.Map(this.$refs.allmap),this.map.centerAndZoom("中国",11),this.map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),this.map.setCurrentCity("北京"),this.map.enableScrollWheelZoom(!0),this.loadSpots("device")}},K={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%",width:"100%"}},[a("div",{attrs:{id:"float-dropdown-menu"}},[a("el-dropdown",{attrs:{"split-button":"",type:"primary"},on:{command:t.loadSpots}},[t._v("\n      聚合级别\n      "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[this.$store.state.user.role<2?a("el-dropdown-item",{attrs:{command:"province"}},[t._v("省")]):t._e(),t._v(" "),this.$store.state.user.role<3?a("el-dropdown-item",{attrs:{command:"city"}},[t._v("市")]):t._e(),t._v(" "),this.$store.state.user.role<4?a("el-dropdown-item",{attrs:{command:"area"}},[t._v("县")]):t._e(),t._v(" "),this.$store.state.user.role<4?a("el-dropdown-item",{attrs:{command:"town"}},[t._v("乡")]):t._e(),t._v(" "),a("el-dropdown-item",{attrs:{command:"device"}},[t._v("设备")])],1)],1)],1),t._v(" "),a("div",{staticStyle:{height:"100%",width:"100%"}},[a("div",{ref:"allmap",attrs:{id:"allmap"}})]),t._v(" "),a("el-dialog",{attrs:{title:"统计信息",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("t-statistics-view",{ref:"statisticsView"})],1)],1)},staticRenderFns:[]};var X,tt=a("VU/8")(Z,K,!1,function(t){a("Kfxg")},null,null).exports,et={data:function(){return{assignCode:!1,assignQRCode:!1,QRDataInfoDialog:{visible:!1,form:{num:0,username:""},managerList:[],numList:[]},QRWorkerDialog:{tabName:"0",visible:!1,saving:!1,workerSide:{workerList:[],deviceList:[],selectedDevices:[],selectedWorker:""},deviceSide:{workerList:[],deviceList:[]}},AssignQRCodeDialog:{totalAvailableCount:0,availableNum:0,visible:!1,workerList:[],numList:[]},searchText:"",QRData:{selectedIndex:-1,list:[],page:1,limit:10,total:0}}},methods:(X={handleDownload:function(){var t="";t=window.location.toString().indexOf("47.103.66.70")>-1?"http://47.103.66.70:8081":"http://localhost:8081",window.location=t+"/QRCode?token="+sessionStorage.token},handleDownloadID:function(){window.location=x.getBaseUrl()+"/export/QRCodeList?adcode="+this.area+"&token="+sessionStorage.token},showQRDataInfoDialog:function(){this.QRDataInfoDialog.visible=!0,this.loadManagers()},loadCanDevices:function(){var t=this;this.QRWorkerDialog.workerSide.deviceList=[],x.requestWithToken("/auth_api/device_can_associate","get",{},function(e){t.QRWorkerDialog.workerSide.deviceList=[];for(var a=0;a<e.data.data.length;++a)t.QRWorkerDialog.workerSide.deviceList.push({key:e.data.data[a],label:e.data.data[a]});for(var i=0;i<t.QRWorkerDialog.workerSide.selectedDevices.length;++i)t.QRWorkerDialog.workerSide.deviceList.push({key:t.QRWorkerDialog.workerSide.selectedDevices[i],label:t.QRWorkerDialog.workerSide.selectedDevices[i]})},function(){})},loadDevice:function(){var t=this;x.requestWithToken("/auth_api/device_list","get",{page:this.QRData.page,limit:this.QRData.limit},function(e){t.QRData.list=e.data.data,t.QRData.total=e.data.totalNum},function(){})},loadManagers:function(){var t=this;x.requestWithToken("/auth_api/user_list","get",{roleType:4,page:1,limit:9999,searchText:""},function(e){t.QRDataInfoDialog.managerList=e.data.data,t.QRDataInfoDialog.numList=[];for(var a=0;a<e.data.data.length;++a)t.QRDataInfoDialog.numList[a]=0},function(){})},handleQRDataCurrentPageChanged:function(t){this.QRData.page=t,this.loadDevice()},handleAddQRCodeDataSubmit:function(){var t=this,e=[];this.assignCode=!0;for(var a=0;a<this.QRDataInfoDialog.managerList.length;++a)e.push({username:this.QRDataInfoDialog.managerList[a].username,num:this.QRDataInfoDialog.numList[a]});x.requestWithTokenJson("/auth_api/QRcode","post",e,function(e){e.data.error||(t.assignCode=!1,alert("成功")),t.assignCode=!1,t.loadDevice(),t.QRDataInfoDialog.visible=!1},function(){})}},R()(X,"handleQRDataCurrentPageChanged",function(){this.loadDevice()}),R()(X,"showQRWorkerDialog",function(){this.QRWorkerDialog.visible=!0,this.QRWorkerDialog.workerSide.selectedWorker="",this.QRWorkerDialog.workerSide.selectedDevices=[],this.workerSideLoadWorkerList(),this.loadCanDevices()}),R()(X,"workerSideLoadAssociatedDevices",function(){var t=this;this.QRWorkerDialog.workerSide.deviceList=[],x.requestWithToken("/auth_api/device_relation","get",{worker:this.QRWorkerDialog.workerSide.selectedWorker},function(e){t.QRWorkerDialog.workerSide.selectedDevices=e.data.data,x.requestWithToken("/auth_api/device_can_associate","get",{},function(e){t.QRWorkerDialog.workerSide.deviceList=[];for(var a=0;a<e.data.data.length;++a)t.QRWorkerDialog.workerSide.deviceList.push({key:e.data.data[a],label:e.data.data[a]});for(var i=0;i<t.QRWorkerDialog.workerSide.selectedDevices.length;++i)t.QRWorkerDialog.workerSide.deviceList.push({key:t.QRWorkerDialog.workerSide.selectedDevices[i],label:t.QRWorkerDialog.workerSide.selectedDevices[i]})},function(){})},function(){})}),R()(X,"workerSideLoadWorkerList",function(){var t=this;x.requestWithToken("/auth_api/user_list","get",{page:1,limit:9999,searchText:""},function(e){t.QRWorkerDialog.workerSide.workerList=e.data.data},function(){})}),R()(X,"handleQRWorkerDialogSubmit",function(){var t=this;console.log(this.QRWorkerDialog.workerSide.selectedDevices);var e=this.QRWorkerDialog.workerSide.selectedWorker;null==e||""==e?alert("请先选择用户"):"0"==this.QRWorkerDialog.tabName&&null!=e&&""!=e&&(this.QRWorkerDialog.saving=!0,x.requestWithTokenJson("/auth_api/device_relation","put",{deviceIds:this.QRWorkerDialog.workerSide.selectedDevices,userId:this.QRWorkerDialog.workerSide.selectedWorker},function(e){t.$message({message:"保存成功",type:"success"}),t.QRWorkerDialog.saving=!1},function(){}))}),R()(X,"showAssignQRCodeDialog",function(){var t=this;this.AssignQRCodeDialog.visible=!0,x.requestWithToken("/auth_api/user_list","get",{page:1,limit:9999,searchText:""},function(e){t.AssignQRCodeDialog.workerList=e.data.data,t.AssignQRCodeDialog.numList=[];for(var a=0;a<e.data.data.length;++a)t.AssignQRCodeDialog.numList[a]=0},function(){}),x.requestWithToken("/auth_api/device_can_associate","get",{},function(e){t.AssignQRCodeDialog.totalAvailableCount=e.data.data.length,t.AssignQRCodeDialog.availableNum=t.AssignQRCodeDialog.totalAvailableCount},function(){})}),R()(X,"handleAssiagnQRCodeNumChange",function(t){for(var e=this,a=0,i=0;i<this.AssignQRCodeDialog.numList.length;++i)a+=this.AssignQRCodeDialog.numList[i];var n=this.AssignQRCodeDialog.totalAvailableCount-a;if(n<0){for(var s=this.AssignQRCodeDialog.numList[t]+n,o=0,r=0;r<this.AssignQRCodeDialog.numList.length;++r)o+=r!=t?this.AssignQRCodeDialog.numList[r]:s;this.AssignQRCodeDialog.availableNum=this.AssignQRCodeDialog.totalAvailableCount-o,console.log("now:"+s+" available:"+this.AssignQRCodeDialog.availableNum+"sum:"+o),this.$nextTick(function(){e.$set(e.AssignQRCodeDialog.numList,t,s)})}else this.AssignQRCodeDialog.availableNum=n}),R()(X,"handleAssignQRCodeDataSubmit",function(){var t=this,e=[];this.assignQRCode=!0;for(var a=0;a<this.AssignQRCodeDialog.numList.length;++a)this.AssignQRCodeDialog.numList[a]>0&&e.push({worker:this.AssignQRCodeDialog.workerList[a].username,num:this.AssignQRCodeDialog.numList[a]});console.log(e),x.requestWithTokenJson("/auth_api/device_relation","post",e,function(e){e.data.error||(t.assignQRCode=!1,t.$message({message:"分配成功",type:"success"}),t.AssignQRCodeDialog.visible=!1),t.assignQRCode=!1},function(){})}),X),mounted:function(){this.loadDevice()}},at={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div"),t._v(" "),a("div",[3==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:t.showQRDataInfoDialog}},[t._v("添加")]):t._e(),t._v(" "),4==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showAssignQRCodeDialog()}}},[t._v("分配二维码")]):t._e(),t._v(" "),4==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showQRWorkerDialog()}}},[t._v("编辑二维码分配")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleDownloadID}},[t._v("ID下载")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleDownload}},[t._v("二维码下载")])],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.QRData.list,height:"600"}},[a("el-table-column",{attrs:{prop:"id",label:"id",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"province",label:"省",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"city",label:"市",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area",label:"县",align:"center"}}),t._v(" "),3==this.$store.state.user.role?a("el-table-column",{attrs:{prop:"manager",label:"管理员",align:"center"}}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.QRData.page,"page-size":10,layout:"total, prev, pager, next",total:t.QRData.total},on:{"current-change":t.handleQRDataCurrentPageChanged,"update:currentPage":function(e){t.$set(t.QRData,"page",e)}}})],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑二维码分配",visible:t.QRWorkerDialog.visible},on:{"update:visible":function(e){t.$set(t.QRWorkerDialog,"visible",e)}}},[a("el-tabs",{model:{value:t.QRWorkerDialog.tabName,callback:function(e){t.$set(t.QRWorkerDialog,"tabName",e)},expression:"QRWorkerDialog.tabName"}},[a("el-tab-pane",{attrs:{label:"工人-设备关联",name:"0"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[a("el-form",[a("el-form-item",{attrs:{label:"工人","label-width":"80px"}},[a("el-select",{on:{change:t.workerSideLoadAssociatedDevices},model:{value:t.QRWorkerDialog.workerSide.selectedWorker,callback:function(e){t.$set(t.QRWorkerDialog.workerSide,"selectedWorker",e)},expression:"QRWorkerDialog.workerSide.selectedWorker"}},t._l(t.QRWorkerDialog.workerSide.workerList,function(t){return a("el-option",{key:t.username,attrs:{value:t.username}})}),1)],1)],1)],1),t._v(" "),a("div",[a("el-transfer",{attrs:{titles:["可分配","已分配"],data:t.QRWorkerDialog.workerSide.deviceList},model:{value:t.QRWorkerDialog.workerSide.selectedDevices,callback:function(e){t.$set(t.QRWorkerDialog.workerSide,"selectedDevices",e)},expression:"QRWorkerDialog.workerSide.selectedDevices"}})],1)])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:t.QRWorkerDialog.saving},nativeOn:{click:function(e){return e.preventDefault(),t.handleQRWorkerDialogSubmit(e)}}},[t._v("保 存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"批量添加二维码",visible:t.QRDataInfoDialog.visible,width:"30%"},on:{"update:visible":function(e){t.$set(t.QRDataInfoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("el-table",{attrs:{data:t.QRDataInfoDialog.managerList}},[a("el-table-column",{attrs:{prop:"username",label:"管理员"}}),t._v(" "),a("el-table-column",{attrs:{label:"分配数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"mini",min:0},model:{value:t.QRDataInfoDialog.numList[e.$index],callback:function(a){t.$set(t.QRDataInfoDialog.numList,e.$index,a)},expression:"QRDataInfoDialog.numList[scope.$index]"}})]}}])})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.QRDataInfoDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.assignCode},nativeOn:{click:function(e){return e.preventDefault(),t.handleAddQRCodeDataSubmit(e)}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"分配二维码",visible:t.AssignQRCodeDialog.visible,width:"30%"},on:{"update:visible":function(e){t.$set(t.AssignQRCodeDialog,"visible",e)}}},[a("div",[t._v("当前可分配设备数量:"+t._s(t.AssignQRCodeDialog.availableNum))]),t._v(" "),a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("el-table",{attrs:{data:t.AssignQRCodeDialog.workerList}},[a("el-table-column",{attrs:{prop:"username",label:"工人"}}),t._v(" "),a("el-table-column",{attrs:{label:"分配数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{size:"mini",value:t.AssignQRCodeDialog.numList[e.$index],min:0},on:{change:function(a){t.handleAssiagnQRCodeNumChange(e.$index)}},model:{value:t.AssignQRCodeDialog.numList[e.$index],callback:function(a){t.$set(t.AssignQRCodeDialog.numList,e.$index,a)},expression:"AssignQRCodeDialog.numList[scope.$index]"}})]}}])})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.AssignQRCodeDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.assignQRCode},nativeOn:{click:function(e){return e.preventDefault(),t.handleAssignQRCodeDataSubmit(e)}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var it=a("VU/8")(et,at,!1,function(t){a("xJpQ")},null,null).exports,nt={data:function(){return{searchText:"",otherBeetleList:[],otherBeetleDict:{},getstartDate:null,getendDate:null,startDate:null,endDate:null,maintenanceData:{list:[],selectedIndex:-1,page:1,limit:10,total:0,startDate:null,endDate:null,selection:[],workingContentDict:["首次悬挂诱捕器","换药+收虫","收虫","其他"]},PhotoDialog:{visible:!1,pic:""},EditMaintenanceDialog:{visible:!1,form:{id:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",workingContent:0,drug:""}}}},methods:{setSearchText:function(t){this.searchText=t},returnlast:function(){this.$router.push({path:"/pages/device_summary"})},loadMaintenanceData:function(){var t=this;this.startDate=this.getstartDate,this.endDate=this.getendDate,null!=this.maintenanceData.startDate&&""!=this.maintenanceData.startDate&&(this.startDate=this.maintenanceData.startDate),null!=this.maintenanceData.endDate&&""!=this.maintenanceData.endDate&&(this.endDate=this.maintenanceData.endDate),this.loadOtherBeetleType(),x.requestWithToken("/auth_api/maintenance2","get",{condition:this.searchText,page:this.maintenanceData.page,limit:this.maintenanceData.limit,startDate:this.startDate,endDate:this.endDate},function(e){t.maintenanceData.list=e.data.data,t.maintenanceData.total=e.data.totalNum},function(){})},handleMaintenanceDataCurrentPageChanged:function(t){this.maintenanceData.page=t,this.loadMaintenanceData()},showPhotoDialog:function(t){this.PhotoDialog.visible=!0;this.PhotoDialog.pic="http://47.103.66.70:8081/device_img?imgName="+t},handleMaintenanceDataSelectionChange:function(t){this.maintenanceData.selection=t,console.log(t)},showEditMaintenanceDataDialog:function(t){this.EditMaintenanceDialog.visible=!0,this.EditMaintenanceDialog.form={id:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",workingContent:0,drug:""},this.EditMaintenanceDialog.form.longitude=t.longitude,this.EditMaintenanceDialog.form.latitude=t.latitude,this.EditMaintenanceDialog.form.workingContent=t.workingContent,this.EditMaintenanceDialog.form.drug=t.drug,this.EditMaintenanceDialog.form.num=t.num,this.EditMaintenanceDialog.form.id=t.id,this.EditMaintenanceDialog.form.otherNum=t.otherNum,this.EditMaintenanceDialog.form.otherType=t.otherType,sessionStorage.setItem("deviceID",t.deviceId),sessionStorage.setItem("username",t.username),sessionStorage.setItem("startDate",this.startDate),sessionStorage.setItem("endDate",this.endDate),this.$router.push({path:"/pages/device_message"})},handleEditMaintenanceDataSubmit:function(){var t=this;x.requestWithTokenJson("/auth_api/maintenance","put",this.EditMaintenanceDialog.form,function(e){t.$message.success("修改成功"),t.EditMaintenanceDialog.visible=!1,t.loadMaintenanceData()},function(){})},loadOtherBeetleType:function(){var t=this;x.requestWithToken("/auth_api/other_beetle","get",{},function(e){t.otherBeetleList=e.data.data;for(var a=0;a<t.otherBeetleList.length;++a)t.otherBeetleDict["t"+t.otherBeetleList[a].id]=t.otherBeetleList[a].name},function(){})},handleReportMaintenanceData:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.selection.length;++a)e.push(this.maintenanceData.selection[a].id);x.requestWithTokenJson("/auth_api/maintenance/report","post",{list:e},function(e){e.data.error||(t.$message.success("上报成功"),t.loadMaintenanceData())},function(){})},exportExcel:function(){window.location=x.getBaseUrl()+"/maintenance/export?startDate="+this.startDate+"&endDate="+this.endDate+"&condition="+this.searchText+"&token="+sessionStorage.token}},mounted:function(){sessionStorage.getItem("SearchText")&&(this.searchText=sessionStorage.getItem("SearchText"),this.getstartDate=sessionStorage.getItem("startDate"),this.getendDate=sessionStorage.getItem("endDate")),this.loadMaintenanceData()}},st={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-link",{attrs:{to:"/pages/device_summary"}},[t._v("诱捕器情况")]),t._v("\n      >设备维护信息\n\n\n  "),a("div",{attrs:{id:"tool-row"}},[a("div",[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.maintenanceData.startDate,callback:function(e){t.$set(t.maintenanceData,"startDate",e)},expression:"maintenanceData.startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.maintenanceData.endDate,callback:function(e){t.$set(t.maintenanceData,"endDate",e)},expression:"maintenanceData.endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.loadMaintenanceData}},[t._v("搜索")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("导出")])],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.maintenanceData.list,height:"600"},on:{"selection-change":t.handleMaintenanceDataSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceId",label:"诱捕器编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"松墨天牛总数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"longitude",label:"经度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"latitude",label:"纬度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"altitude",label:"海拔"}}),t._v(" "),a("el-table-column",{attrs:{label:"行政区域",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.province+e.row.city+e.row.area+e.row.town))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"工人"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.showEditMaintenanceDataDialog(e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.maintenanceData.page,"page-size":10,layout:"total, prev, pager, next",total:t.maintenanceData.total},on:{"current-change":t.handleMaintenanceDataCurrentPageChanged,"update:currentPage":function(e){t.$set(t.maintenanceData,"page",e)}}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"编辑维护信息",visible:t.EditMaintenanceDialog.visible,width:"30%"},on:{"update:visible":function(e){t.$set(t.EditMaintenanceDialog,"visible",e)}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"松墨天牛数量"}},[a("el-input-number",{attrs:{min:0},model:{value:t.EditMaintenanceDialog.form.num,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"num",e)},expression:"EditMaintenanceDialog.form.num"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"其他天牛类型"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.otherType,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"otherType",e)},expression:"EditMaintenanceDialog.form.otherType"}},[a("el-option",{key:t.无,attrs:{label:t.无,value:""}},[t._v("无")]),t._v(" "),t._l(t.otherBeetleList,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"其他天牛数量"}},[a("el-input-number",{attrs:{min:0},model:{value:t.EditMaintenanceDialog.form.otherNum,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"otherNum",e)},expression:"EditMaintenanceDialog.form.otherNum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"药剂类型"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.drug,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"drug",e)},expression:"EditMaintenanceDialog.form.drug"}},[a("el-option",{attrs:{label:"APF-I持久增强型",value:"APF-I持久增强型"}},[t._v("APF-I持久增强型")]),t._v(" "),a("el-option",{attrs:{label:"APF-I持久型",value:"APF-I持久型"}},[t._v("APF-I持久型")]),t._v(" "),a("el-option",{attrs:{label:"APF-I普通型",value:"APF-I普通型"}},[t._v("APF-I普通型")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"工作内容"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.workingContent,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"workingContent",e)},expression:"EditMaintenanceDialog.form.workingContent"}},[a("el-option",{attrs:{value:0,label:"首次悬挂诱捕器"}},[t._v("首次悬挂诱捕器")]),t._v(" "),a("el-option",{attrs:{value:1,label:"换药+收虫"}},[t._v("换药+收虫")]),t._v(" "),a("el-option",{attrs:{value:2,label:"收虫"}},[t._v("收虫")]),t._v(" "),a("el-option",{attrs:{value:3,label:"其他"}},[t._v("其他")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.EditMaintenanceDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleEditMaintenanceDataSubmit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var ot=a("VU/8")(nt,st,!1,function(t){a("jBV8")},null,null).exports,rt={data:function(){return{searchText:"",otherBeetleList:[],otherBeetleDict:{},checkBoxData:[],maintenanceData:{list:[],selectedIndex:-1,page:1,limit:10,total:0,startDate:null,endDate:null,selection:[],workingContentDict:["首次悬挂诱捕器","换药+收虫","收虫","其他"]},PhotoDialog:{visible:!1,pic:""},EditMaintenanceDialog:{visible:!1,form:{id:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",workingContent:0,drug:""}}}},methods:{handleUserDelete:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.selection.length;++a)e.push(this.maintenanceData.selection[a].id);x.requestWithTokenJson("/auth_api/maintenance/abnormal","post",{list:e},function(e){e.data.error?t.$message.error("上报失败"):t.$message.success("上报成功")},function(){}),loadMaintenanceData()},setSearchText:function(t){this.searchText=t},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){x.requestWithToken("/auth_api/maintenance/abnormal","delete",{id:t.id,deviceID:t.deviceId},function(t){t.data.error?e.$message({type:"error",message:"删除失败!"}):(e.loadMaintenanceData(),e.$message({type:"success",message:"删除成功!"}))},function(){})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}),this.loadMaintenanceData()},loadMaintenanceData:function(){var t=this;this.loadOtherBeetleType(),x.requestWithToken("/auth_api/maintenance/abnormal","get",{condition:this.searchText,page:this.maintenanceData.page,limit:this.maintenanceData.limit,startDate:this.maintenanceData.startDate,endDate:this.maintenanceData.endDate},function(e){t.maintenanceData.list=e.data.data,t.maintenanceData.total=e.data.totalNum},function(){})},handleMaintenanceDataCurrentPageChanged:function(t){this.maintenanceData.page=t,this.loadMaintenanceData()},showPhotoDialog:function(t){this.PhotoDialog.visible=!0;this.PhotoDialog.pic="http://47.103.66.70:8081/device_img?imgName="+t},handleMaintenanceDataSelectionChange:function(t){this.maintenanceData.selection=t,console.log(t)},showEditMaintenanceDataDialog:function(t){this.EditMaintenanceDialog.visible=!0,this.EditMaintenanceDialog.form={id:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",workingContent:0,drug:""},this.EditMaintenanceDialog.form.longitude=t.longitude,this.EditMaintenanceDialog.form.latitude=t.latitude,this.EditMaintenanceDialog.form.workingContent=t.workingContent,this.EditMaintenanceDialog.form.drug=t.drug,this.EditMaintenanceDialog.form.num=t.num,this.EditMaintenanceDialog.form.id=t.id,this.EditMaintenanceDialog.form.otherNum=t.otherNum,this.EditMaintenanceDialog.form.otherType=t.otherType},handleEditMaintenanceDataSubmit:function(){var t=this;x.requestWithTokenJson("/auth_api/maintenance/abnormal","put",this.EditMaintenanceDialog.form,function(e){t.$message.success("修改成功"),t.EditMaintenanceDialog.visible=!1,t.loadMaintenanceData()},function(){})},loadOtherBeetleType:function(){var t=this;x.requestWithToken("/auth_api/other_beetle","get",{},function(e){t.otherBeetleList=e.data.data;for(var a=0;a<t.otherBeetleList.length;++a)t.otherBeetleDict["t"+t.otherBeetleList[a].id]=t.otherBeetleList[a].name},function(){})},handleReportMaintenanceData:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.selection.length;++a)e.push(this.maintenanceData.selection[a].id);x.requestWithTokenJson("/auth_api/maintenance/abnormal/report","post",{list:e},function(e){e.data.error?(t.$message.error("上报存在失败"),t.loadMaintenanceData()):(t.$message.success("上报成功"),t.loadMaintenanceData())},function(){})},exportExcel:function(){window.location=x.getBaseUrl()+"/maintenance/export?startDate="+this.maintenanceData.startDate+"&endDate="+this.maintenanceData.endDate+"&token="+sessionStorage.token}},mounted:function(){this.loadMaintenanceData()}},lt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div",[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"搜索"},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.maintenanceData.startDate,callback:function(e){t.$set(t.maintenanceData,"startDate",e)},expression:"maintenanceData.startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.maintenanceData.endDate,callback:function(e){t.$set(t.maintenanceData,"endDate",e)},expression:"maintenanceData.endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.loadMaintenanceData}},[t._v("搜索")])],1),t._v(" "),a("div",[3==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:t.handleReportMaintenanceData}},[t._v("上报")]):t._e()],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.maintenanceData.list,height:"600"},on:{"selection-change":t.handleMaintenanceDataSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceId",label:"设备ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"松墨天牛数量"}}),t._v(" "),a("el-table-column",{attrs:{label:"其他天牛类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.otherBeetleDict["t"+e.row.otherType])+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"otherNum",label:"其他天牛数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"longitude",label:"经度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"latitude",label:"纬度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"altitude",label:"海拔"}}),t._v(" "),a("el-table-column",{attrs:{label:"位置",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.province+e.row.city+e.row.area+e.row.town))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{label:"工作内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.maintenanceData.workingContentDict[e.row.workingContent]))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"drug",label:"药剂类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"现场照片",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.imageId&&""!=e.row.imageId?a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.showPhotoDialog(e.row.imageId)}}},[t._v("显示")]):t._e()]}}])}),t._v(" "),6==this.$store.state.user.role||3==this.$store.state.user.role?a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.reported?t._e():a("div",[e.row.reported?t._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.showEditMaintenanceDataDialog(e.row)}}},[t._v("编辑")]),t._v(" "),e.row.reported?t._e():a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])],1),t._v(" "),e.row.reported?a("div",[t._v("不可操作")]):t._e()]}}])}):t._e()],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.maintenanceData.page,"page-size":10,layout:"total, prev, pager, next",total:t.maintenanceData.total},on:{"current-change":t.handleMaintenanceDataCurrentPageChanged,"update:currentPage":function(e){t.$set(t.maintenanceData,"page",e)}}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"编辑维护信息",visible:t.EditMaintenanceDialog.visible,width:"30%"},on:{"update:visible":function(e){t.$set(t.EditMaintenanceDialog,"visible",e)}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"经度"}},[a("el-input",{staticStyle:{width:"150px"},model:{value:t.EditMaintenanceDialog.form.longitude,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"longitude",e)},expression:"EditMaintenanceDialog.form.longitude"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"纬度"}},[a("el-input",{staticStyle:{width:"150px"},model:{value:t.EditMaintenanceDialog.form.latitude,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"latitude",e)},expression:"EditMaintenanceDialog.form.latitude"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.EditMaintenanceDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleEditMaintenanceDataSubmit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var ct=a("VU/8")(rt,lt,!1,function(t){a("Kx/P")},null,null).exports,ut={data:function(){return{showCity:!0,showArea:!0,provinces:[],province:"",cities:[],city:"",areas:[],area:"",towns:[],town:"",managers:[],manager:"",startDate:"",endDate:"",contentLabelDict:["市","县","乡镇","工人"],contentLabelIndex:0,summaryList:[],analysisList:[],mcList:[],tabPage:"first",mcType:"0"}},methods:{init:function(){this.showCity=!0,this.showArea=!0;var t=this.$store.state.user.role;1==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.loadCity()):2==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.loadArea()):3==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.loadManagers()):4==t&&(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.manager=this.$store.state.user.username)},exportExcel:function(){var t=this.$store.state.user.role;4==t&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token),3==t&&(""==this.manager?window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token:window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token),2==t&&(""==this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.city+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=1&token="+sessionStorage.token),""!=this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token),""!=this.area&&""!=this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token)),1==t&&(""==this.city&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.province+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=0&token="+sessionStorage.token),""!=this.city&&""==this.area&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.city+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=1&token="+sessionStorage.token),""!=this.city&&""!=this.area&&""==this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?adcode="+this.area+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=2&token="+sessionStorage.token),""!=this.city&&""!=this.area&&""!=this.manager&&(window.location=x.getBaseUrl()+"/statistics/export?manager="+this.manager+"&startDate="+this.startDate+"&endDate="+this.endDate+"&type=3&token="+sessionStorage.token))},query:function(){this.tabPage="first";var t=this.$store.state.user.role;4==t&&this.queryWorkerData(),3==t&&(""==this.manager?this.queryTownData():this.queryWorkerData()),2==t&&(""==this.area&&""==this.manager&&this.queryAreaData(),""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.area&&""!=this.manager&&this.queryWorkerData()),1==t&&(""==this.city&&this.queryCityData(),""!=this.city&&""==this.area&&this.queryAreaData(),""!=this.city&&""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.city&&""!=this.area&&""!=this.manager&&this.queryWorkerData())},queryWorkerData:function(){var t=this;this.contentLabelIndex=3,x.requestWithToken("/auth_api/statistics/worker","get",{manager:this.manager,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryTownData:function(){var t=this;this.contentLabelIndex=2,x.requestWithToken("/auth_api/statistics/town","get",{adcode:this.area,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryAreaData:function(){var t=this;this.contentLabelIndex=1,x.requestWithToken("/auth_api/statistics/area","get",{adcode:this.city,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},queryCityData:function(){var t=this;this.contentLabelIndex=0,x.requestWithToken("/auth_api/statistics/city","get",{adcode:this.province,startDate:this.startDate,endDate:this.endDate},function(e){e.data.error?(t.$message.error("无数据"),t.summaryList=[],t.mcList=[],t.makeAnalysisData([])):(t.summaryList=e.data.data.summaryList,t.mcList=[],e.data.data.multipleComparisonsList.length>2?t.mcList=e.data.data.multipleComparisonsList:t.$message.error("数据量不足"),t.makeAnalysisData(e.data.data.analysisEntity)),t.drawChart()},function(){})},drawChart:function(){var t=P.a.init(this.$refs.echartsArea),e=[],a=[],i=[];if(0==this.summaryList.length)t.clear();else{for(var n=0;n<this.summaryList.length;++n)e.push(this.summaryList[n].name),a.push(this.summaryList[n].mean),i.push([n,this.summaryList[n].mean-this.summaryList[n].std,this.summaryList[n].mean+this.summaryList[n].std]);var s={toolbox:{show:!0,feature:{saveAsImage:{show:!0,excludeComponents:["toolbox"],pixelRatio:2}}},title:{text:"统计分析图",x:"center",y:"top",textAlign:"center"},tooltip:{show:!1},xAxis:{name:this.contentLabelDict[this.contentLabelIndex],nameLocation:"center",nameTextStyle:{padding:[20,0,0,0]},data:e},yAxis:{name:"诱虫量",nameLocation:"center",nameTextStyle:{padding:[0,0,20,0]}},series:[{name:"均值",type:"bar",data:a,itemStyle:{normal:{color:"#77bef7"}}},{type:"custom",name:"标准差",itemStyle:{normal:{borderWidth:1.5,color:"#000000"}},renderItem:function(t,e){var a=e.value(0),i=e.coord([a,e.value(1)]),n=e.coord([a,e.value(2)]),s=(e.size([1,0])[0],e.style({stroke:e.visual("color"),fill:null}));return{type:"group",children:[{type:"line",shape:{x1:i[0]-5,y1:i[1],x2:i[0]+5,y2:i[1]},style:s},{type:"line",shape:{x1:i[0],y1:i[1],x2:n[0],y2:n[1]},style:s},{type:"line",shape:{x1:n[0]-5,y1:n[1],x2:n[0]+5,y2:n[1]},style:s}]}},encode:{x:0,y:[1,2]},data:i,z:100}]};t.setOption(s)}},makeAnalysisData:function(t){console.log(t);var e=[];e.push({0:this.contentLabelDict[this.contentLabelIndex]+"间",1:t.ssa,2:t.dfa,3:t.msa,4:t.f,5:t.fcrit,6:t.r}),e.push({0:this.contentLabelDict[this.contentLabelIndex]+"内",1:t.sse,2:t.dfe,3:t.mse,4:"",5:"",6:""}),e.push({0:"总计",1:t.sst,2:t.dft,3:"",4:"",5:"",6:""}),this.analysisList=e,console.log(this.analysisList)},loadProvince:function(){var t=this;x.requestWithToken("/auth_api/dist/provinces","get",{},function(e){console.log(e.data),t.provinces=e.data,t.province="",t.city="",t.area="",t.cities=[],t.areas=[]},function(){})},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.province},function(e){t.cities=e.data,t.city="",t.area="",t.areas=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.city},function(e){t.area="",t.areas=e.data},function(){})},loadManagers:function(){var t=this;x.requestWithToken("/auth_api/manager_list","get",{adcode:this.area},function(e){t.managers=e.data.data,console.log(t.managers)},function(){})},areaChanged:function(){this.manager="",this.loadManagers()},cityChanged:function(){this.area="",this.manager="",this.loadArea()},tableRowStyle:function(t){t.row,t.rowIndex;return"border: 0;border-top-color:white;"},tableHeaderColor:function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;if(0===e)return"background-color: lightblue;color: #fff;font-weight: 500;"}},mounted:function(){this.init()}},dt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[this.$store.state.user.role<2&&t.showCity?a("el-select",{attrs:{placeholder:"市"},on:{change:t.cityChanged},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.cities,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),this.$store.state.user.role<3&&t.showArea?a("el-select",{attrs:{placeholder:"县"},on:{change:function(e){t.areaChanged()}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.areas,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.query()}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportExcel()}}},[t._v("保存表格")])],1),t._v(" "),a("el-tabs",{attrs:{id:"statistics-tabs",type:"card"},model:{value:t.tabPage,callback:function(e){t.tabPage=e},expression:"tabPage"}},[a("el-tab-pane",{attrs:{label:"描述性统计分析",name:"first"}},[a("el-card",{staticStyle:{padding:"5px"},attrs:{header:"描述性统计分析表"}},[a("el-table",{attrs:{data:t.summaryList,"row-style":t.tableRowStyle}},[a("el-table-column",{attrs:{label:t.contentLabelDict[t.contentLabelIndex],prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"诱捕器数量",prop:"count"}}),t._v(" "),a("el-table-column",{attrs:{label:"总诱虫量",prop:"sum"}}),t._v(" "),a("el-table-column",{attrs:{label:"平均",prop:"mean"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准差",prop:"std"}}),t._v(" "),a("el-table-column",{attrs:{label:"最大值",prop:"max"}}),t._v(" "),a("el-table-column",{attrs:{label:"最小值",prop:"min"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信区间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.confidenceLo+"~"+e.row.confidenceHi))]}}])})],1)],1),t._v(" "),a("el-card",{staticStyle:{padding:"5px"}},[a("div",{ref:"echartsArea",staticStyle:{width:"100%",height:"300px"}})])],1),t._v(" "),a("el-tab-pane",{attrs:{label:"方差分析",name:"second"}},[a("el-card",[a("el-table",{attrs:{data:t.analysisList}},[a("el-table-column",{attrs:{label:"差异源",prop:"0"}}),t._v(" "),a("el-table-column",{attrs:{label:"平方和SS",prop:"1"}}),t._v(" "),a("el-table-column",{attrs:{label:"自由度DF",prop:"2"}}),t._v(" "),a("el-table-column",{attrs:{label:"方差MS",prop:"3"}}),t._v(" "),a("el-table-column",{attrs:{label:"统计量F",prop:"4"}}),t._v(" "),a("el-table-column",{attrs:{label:"临界值F crit",prop:"5"}}),t._v(" "),a("el-table-column",{attrs:{label:"相关系数R",prop:"6"}})],1),t._v(" "),a("label",[t._v("备注：当统计量F>临界值F时，方差分析达到显著差异")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"多重比较",name:"third"}},[a("el-card",{staticStyle:{width:"100%",padding:"5px"},attrs:{header:"差异性分析"}},[a("el-select",{model:{value:t.mcType,callback:function(e){t.mcType=e},expression:"mcType"}},[a("el-option",{key:"LSD",attrs:{value:"0",label:"LSD"}},[t._v("LSD")]),t._v(" "),a("el-option",{key:"SCHEFFE",attrs:{value:"1",label:"SCHEFFE"}},[t._v("SCHEFFE")])],1),t._v(" "),0==t.mcType?a("el-table",{attrs:{data:t.mcList}},[a("el-table-column",{attrs:{label:"(i)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelA"}}),t._v(" "),a("el-table-column",{attrs:{label:"(j)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelB"}}),t._v(" "),a("el-table-column",{attrs:{label:"均值差值",prop:"dv"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准误",prop:"standardError"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信下限",prop:"lsdConfidenceLo"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信上限",prop:"lsdConfidenceHi"}}),t._v(" "),a("el-table-column",{attrs:{label:"LSD值",prop:"lsd"}}),t._v(" "),a("el-table-column",{attrs:{label:"差异显著"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.lsdSignificance?"是":"否"))]}}])})],1):t._e(),t._v(" "),1==t.mcType?a("el-table",{attrs:{data:t.mcList}},[a("el-table-column",{attrs:{label:"(i)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelA"}}),t._v(" "),a("el-table-column",{attrs:{label:"(j)"+t.contentLabelDict[t.contentLabelIndex],prop:"labelB"}}),t._v(" "),a("el-table-column",{attrs:{label:"均值差值",prop:"dv"}}),t._v(" "),a("el-table-column",{attrs:{label:"标准误",prop:"standardError"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信下限",prop:"scheffeConfidenceLo"}}),t._v(" "),a("el-table-column",{attrs:{label:"置信上限",prop:"scheffeConfidenceHi"}}),t._v(" "),a("el-table-column",{attrs:{label:"D值",prop:"scheffe"}}),t._v(" "),a("el-table-column",{attrs:{label:"差异显著"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.scheffeSignificance?"是":"否"))]}}])})],1):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var ht=a("VU/8")(ut,dt,!1,function(t){a("I2ZZ")},null,null).exports,mt={data:function(){return{list:[],townUserListCanAdd:[],townUserToAdd:"",allList:"",leftlist:[],dialogVisible:!1,townUserDialogVisible:!1,isAdd:!0,form:{id:"",name:""}}},methods:{loadOtherBeetleData:function(){var t=this,e="/auth_api/other_beetle";3==this.$store.state.user.role&&(e="/auth_api/other_beetle/town"),x.requestWithToken(e,"get",{},function(e){t.list=e.data.data,3==t.$store.state.user.role&&t.loadAll()},function(){})},loadAll:function(){var t=this;this.townUserListCanAdd=[],x.requestWithToken("/auth_api/other_beetle","get",{},function(e){t.leftlist=e.data.data;for(var a=0;a<t.leftlist.length;++a){for(var i=0,n=0;n<t.list.length;++n)if(t.leftlist[a].id==t.list[n].id){i=1;break}0==i&&(t.allList=t.leftlist[a],t.townUserListCanAdd.push(t.allList))}},function(){})},showAdd:function(){if(3==this.$store.state.user.role)return this.townUserToAdd="",void(this.townUserDialogVisible=!0);this.isAdd=!0,this.form.id="",this.form.name="",this.dialogVisible=!0},showEdit:function(t){this.isAdd=!1,this.form.id=t.id,this.form.name=t.name,this.dialogVisible=!0},handleTownSubmit:function(){var t=this;x.requestWithToken("/auth_api/other_beetle","post",{name:this.form.name},function(e){e.data.error||(t.$message.success("添加成功"),t.townUserDialogVisible=!1),t.loadOtherBeetleData()},function(){})},handleSubmit:function(){var t=this;this.isAdd?x.requestWithToken("/auth_api/other_beetle","post",{name:this.form.name},function(e){e.data.error||(t.$message.success("添加成功"),t.dialogVisible=!1),t.loadOtherBeetleData()},function(){}):x.requestWithToken("/auth_api/other_beetle","put",{id:this.form.id,name:this.form.name},function(e){e.data.error||(t.$message.success("修改成功"),t.dialogVisible=!1,t.loadOtherBeetleData())})},handleSubmitTownUser:function(){var t=this;x.requestWithToken("/auth_api/other_beetle/town","post",{beetleInfoId:this.townUserToAdd},function(e){e.data.error||(t.$message.success("添加成功"),t.townUserDialogVisible=!1),t.loadOtherBeetleData()},function(){})},handleDelete:function(t){var e=this;0==this.$store.state.user.role?x.requestWithToken("/auth_api/other_beetle","delete",{id:t.id},function(t){t.data.error||(e.$message.success("删除成功"),e.dialogVisible=!1,e.loadOtherBeetleData())},function(){}):3==this.$store.state.user.role&&x.requestWithToken("/auth_api/other_beetle/town","delete",{beetleInfoId:t.id},function(t){t.data.error||(e.$message.success("删除成功"),e.dialogVisible=!1),e.loadOtherBeetleData()},function(){})}},mounted:function(){this.loadOtherBeetleData()}},pt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div"),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.showAdd}},[t._v("增加")])],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.list,height:"600"}},[a("el-table-column",{attrs:{prop:"id",label:"id"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.$store.state.user.role?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.showEdit(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.isAdd?"增加":"编辑",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{"label-width":"150px"}},[t.isAdd?t._e():a("el-form-item",{attrs:{label:"id"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{disabled:""},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{staticStyle:{width:"150px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"增加",visible:t.townUserDialogVisible,width:"30%"},on:{"update:visible":function(e){t.townUserDialogVisible=e}}},[a("el-select",{model:{value:t.townUserToAdd,callback:function(e){t.townUserToAdd=e},expression:"townUserToAdd"}},t._l(t.townUserListCanAdd,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleSubmitTownUser(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var vt=a("VU/8")(mt,pt,!1,function(t){a("8NFj")},null,null).exports,gt={data:function(){return{activeTab:"first",startDate:"",endDate:"",list:[],page:1,total:0,provinces:[],cities:[],areas:[],province:"",city:"",area:"",hourlyList:[],monthlyList:[],monthReceList:[],hourlyPage:1,monthlyPage:1,hourlyTotal:0,monthlyTotal:0}},methods:{download:function(){"first"==this.activeTab?window.location=x.getBaseUrl()+"/weather/export?adcode="+this.area+"&lo="+this.startDate+"&hi="+this.endDate+"&token="+sessionStorage.token:"second"==this.activeTab?window.location=x.getBaseUrl()+"/weather/export/hourly?adcode="+this.area+"&lo="+this.startDate+"&hi="+this.endDate+"&token="+sessionStorage.token:"third"==this.activeTab&&(window.location=x.getBaseUrl()+"/weather/export/monthly?adcode="+this.area+"&lo="+this.startDate+"&hi="+this.endDate+"&token="+sessionStorage.token)},query:function(){"first"==this.activeTab?this.loadWeatherInfo():"second"==this.activeTab?this.loadHourlyWeaherInfo():"third"==this.activeTab&&this.loadMonthlyWeaherInfo()},handleCurrentPageChanged:function(t){this.page=t,this.loadWeatherInfo()},handleHourlyWeatherCurrentPageChanged:function(t){alert(),this.hourlyPage=t,this.loadHourlyWeaherInfo()},handleMonthlyWeatherCurrentPageChanged:function(t){alert(),this.monthlyPage=t,this.loadMonthlyWeaherInfo()},loadProvince:function(){var t=this;x.requestWithToken("/auth_api/dist/provinces","get",{},function(e){console.log(e.data),t.provinces=e.data,t.province="",t.city="",t.area="",t.cities=[],t.areas=[]},function(){})},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.province},function(e){t.cities=e.data,t.city="",t.area="",t.areas=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.city},function(e){t.area="",t.areas=e.data},function(){})},loadWeatherInfo:function(){var t=this;x.requestWithToken("/weather/list","get",{adcode:this.area,lo:this.startDate,hi:this.endDate,page:this.page,limit:10},function(e){e.data.data.totalNum>0?(t.list=e.data.data.data,t.total=e.data.data.totalNum):t.list=[]},function(){})},loadHourlyWeaherInfo:function(){var t=this;x.requestWithToken("/weather/hourly/list","get",{adcode:this.area,lo:this.startDate,hi:this.endDate,page:this.hourlyPage,limit:10},function(e){t.hourlyTotal=e.data.data.totalNum,t.hourlyTotal>0?t.hourlyList=e.data.data.data:t.hourlyList=[]},function(){})},loadMonthlyWeaherInfo:function(){var t=this;x.requestWithToken("/weather/monthly/list","get",{adcode:this.area,lo:this.startDate,hi:this.endDate,page:this.monthlyPage,limit:1e3},function(e){if(t.monthlyTotal=e.data.data.totalNum,t.monthlyTotal>0){t.monthReceList=e.data.data.data;for(var a=0;a<t.monthReceList.length;++a)t.monthReceList[a].date="",t.monthReceList[a].date=t.monthReceList[a].year+"年"+t.monthReceList[a].month+"月";t.monthlyList=t.monthReceList}else t.monthlyList=[]},function(){})}},mounted:function(){this.loadProvince()}},ft={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div",[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"省份"},on:{change:t.loadCity},model:{value:t.province,callback:function(e){t.province=e},expression:"province"}},t._l(t.provinces,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"市"},on:{change:t.loadArea},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},t._l(t.cities,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1),t._v(" "),a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"县"},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},t._l(t.areas,function(t){return a("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.query()}}},[t._v("搜索")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.download()}}},[t._v("下载")])],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"每日天气",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.list,height:"600"}},[a("el-table-column",{attrs:{prop:"tempMean",label:"平均温度  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tempMin",label:"最低温  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tempMax",label:"最高温  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hum",label:"相对湿度 %"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.page,"page-size":10,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentPageChanged,"update:currentPage":function(e){t.page=e}}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"逐小时天气",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.hourlyList,height:"600"}},[a("el-table-column",{attrs:{prop:"tmp",label:"温度  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fl",label:"体感温度  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hum",label:"湿度 %"}}),t._v(" "),a("el-table-column",{attrs:{prop:"condTxt",label:"天气"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pcpn",label:"降水量 mm"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pres",label:"大气压 KPa"}}),t._v(" "),a("el-table-column",{attrs:{prop:"vis",label:"能见度 km"}}),t._v(" "),a("el-table-column",{attrs:{prop:"windDeg",label:"风向角度 ° "}}),t._v(" "),a("el-table-column",{attrs:{prop:"windDir",label:"风向"}}),t._v(" "),a("el-table-column",{attrs:{prop:"windSc",label:"风力 级"}}),t._v(" "),a("el-table-column",{attrs:{prop:"windSpd",label:"风速 m/s"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.hourlyPage,"page-size":10,layout:"total, prev, pager, next",total:t.hourlyTotal},on:{"current-change":t.handleHourlyWeatherCurrentPageChanged,"update:currentPage":function(e){t.hourlyPage=e}}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"每月天气",name:"third"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.monthlyList,height:"600"}},[a("el-table-column",{attrs:{prop:"tempMean",label:"平均温度  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tempMin",label:"最低温  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tempMax",label:"最高温  ℃"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hum",label:"相对湿度 %"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"月份"}})],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.monthlyPage,"page-size":10,layout:"total, prev, pager, next",total:t.monthlyTotal},on:{"current-change":t.handleMonthlyWeatherCurrentPageChanged,"update:currentPage":function(e){t.monthlyPage=e}}})],1)],1)],1)],1)])},staticRenderFns:[]};var bt=a("VU/8")(gt,ft,!1,function(t){a("NSnf")},null,null).exports,Dt={components:{"t-maintenance-data":ot},data:function(){return{returNnum:0,levelList:null,dialogVisible:!1,provinces:[],province:"",cities:[],city:"",areas:[],area:"",towns:[],town:"",managers:[],manager:"",startDate:"",endDate:"",contentLabelDict:["市","县","乡镇","管理员","工人"],contentLabelIndex:0,summaryData:[],deviceCount:0,beetleCount:0,dCount:0,bCount:0,summaryDeviceData:{list:[],page:1,limit:9999,name:"",deviceCount:0,beetleCount:0},managerData:[],summaryManagerData:{list:[],page:1,limit:9999,name:"",deviceCount:0,beetleCount:0},summaryWorkerData:{list:[],page:1,limit:9999,name:"",deviceCount:0,beetleCount:0},tabPage:"first",totalCount:0,totalSum:0}},methods:{init:function(){var t=this.$store.state.user.role;1==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.loadCity()):2==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.loadArea()):3==t?(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.loadManagers()):4==t&&(this.province=this.$store.state.user.adcode.substr(0,2),this.city=this.$store.state.user.adcode.substr(0,4),this.area=this.$store.state.user.adcode,this.manager=this.$store.state.user.username)},querySum:function(t){var e=this;x.requestWithToken("/auth_api/device_summary/sum","get",{adcode:t,startDate:this.startDate,endDate:this.endDate},function(t){e.totalCount=t.data.data.count,e.totalSum=t.data.data.sum},function(){})},query:function(){this.tabPage="first";var t=this.$store.state.user.role;4==t&&this.queryWorkerData(this.manager),3==t&&(""==this.manager?this.queryTownData():this.queryManagerData()),2==t&&(""==this.area&&""==this.manager&&this.queryAreaData(),""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.area&&""!=this.manager&&this.queryWorkerData()),1==t&&(""==this.city&&this.queryCityData(),""!=this.city&&""==this.area&&this.queryAreaData(),""!=this.city&&""!=this.area&&""==this.manager&&this.queryTownData(),""!=this.city&&""!=this.area&&""!=this.manager&&this.queryWorkerData())},queryWorkerData:function(t){var e=this;x.requestWithToken("/auth_api/device_summary/worker","get",{adcode:t,startDate:this.startDate,endDate:this.endDate,page:this.summaryWorkerData.page,limit:this.summaryWorkerData.limit},function(t){e.summaryWorkerData.list=t.data.data.data,4==e.$store.state.user.role&&e.querySum(e.manager)},function(){})},summaryTotalData:function(){if(this.dCount=0,this.bCount=0,this.summaryData.length>0){for(var t=0;t<this.summaryData.length;++t)this.dCount=this.summaryData[t].deviceCount,this.bCount=this.summaryData[t].beetleCount;this.totalCount=this.dCount,this.totalSum=this.bCount}else this.totalCount=0,this.totalSum=0},queryTownData:function(){var t=this;this.contentLabelIndex=2,x.requestWithToken("/auth_api/device_summary/area","get",{adcode:this.area,startDate:this.startDate,endDate:this.endDate,page:this.summaryDeviceData.page,limit:this.summaryDeviceData.limit},function(e){t.summaryDeviceData.list=e.data.data.data},function(){}),3==this.$store.state.user.role?this.queryManagerData():(this.queryWorkerData(this.area),this.querySum(this.area))},queryManagerData:function(){var t=this;this.contentLabelIndex=2,x.requestWithToken("/auth_api/device_summary/manager","get",{adcode:this.area,startDate:this.startDate,endDate:this.endDate,page:this.summaryDeviceData.page,limit:this.summaryDeviceData.limit},function(e){t.summaryManagerData.list=e.data.data.data,t.managerData=e.data.data},function(){}),this.querySum(this.area)},queryAreaData:function(){var t=this;this.contentLabelIndex=1,x.requestWithToken("/auth_api/device_summary/city","get",{adcode:this.city,startDate:this.startDate,endDate:this.endDate,page:this.summaryDeviceData.page,limit:this.summaryDeviceData.limit},function(e){t.summaryDeviceData.list=e.data.data.data},function(){}),this.queryWorkerData(this.city),this.querySum(this.city)},queryCityData:function(){var t=this;this.contentLabelIndex=0,x.requestWithToken("/auth_api/device_summary/province","get",{adcode:this.province,startDate:this.startDate,endDate:this.endDate,page:this.summaryDeviceData.page,limit:this.summaryDeviceData.limit},function(e){t.summaryDeviceData.list=e.data.data.data},function(){}),this.queryWorkerData(this.province),this.querySum(this.province)},makeAnalysisData:function(t){console.log(t);var e=[];e.push({0:this.contentLabelDict[this.contentLabelIndex]+"间",1:t.ssa,2:t.dfa,3:t.msa,4:t.f,5:t.fcrit,6:t.r}),e.push({0:this.contentLabelDict[this.contentLabelIndex]+"内",1:t.sse,2:t.dfe,3:t.mse,4:"",5:"",6:""}),e.push({0:"总计",1:t.sst,2:t.dft,3:"",4:"",5:"",6:""}),this.analysisList=e,console.log(this.analysisList)},loadProvince:function(){var t=this;x.requestWithToken("/auth_api/dist/provinces","get",{},function(e){console.log(e.data),t.provinces=e.data,t.province="",t.city="",t.area="",t.cities=[],t.areas=[]},function(){})},loadCity:function(){var t=this;x.requestWithToken("/auth_api/dist/cities","get",{id:this.province},function(e){t.cities=e.data,t.city="",t.area="",t.areas=[]},function(){})},loadArea:function(){var t=this;x.requestWithToken("/auth_api/dist/areas","get",{id:this.city},function(e){t.area="",t.areas=e.data},function(){})},loadManagers:function(){var t=this;x.requestWithToken("/auth_api/manager_list","get",{adcode:this.area},function(e){t.managers=e.data.data,console.log(t.managers)},function(){})},areaChanged:function(){this.manager="",this.loadManagers()},cityChanged:function(){this.area="",this.manager="",this.loadArea()},tableRowStyle:function(t){t.row,t.rowIndex;return"border: 0;border-top-color:white;"},tableHeaderColor:function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;if(0===e)return"background-color: lightblue;color: #fff;font-weight: 500;"},showMaintenanceView:function(t){var e=this;this.dialogVisible=!0,this.$nextTick(function(){e.$refs.maintenanceView.setSearchText(t),e.$refs.maintenanceView.loadMaintenanceData()}),sessionStorage.setItem("SearchText",t),sessionStorage.setItem("startDate",this.startDate),sessionStorage.setItem("endDate",this.endDate),this.$router.push({path:"/pages/device_maintenance.html"})}},mounted:function(){this.init()}},yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[this.$store.state.user.role<2?a("el-select",{attrs:{placeholder:"市"},on:{change:t.cityChanged},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.cities,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),this.$store.state.user.role<3?a("el-select",{attrs:{placeholder:"县"},on:{change:function(e){t.areaChanged()}},model:{value:t.area,callback:function(e){t.area=e},expression:"area"}},[a("el-option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),t._l(t.areas,function(t){return a("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})})],2):t._e(),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.query()}}},[t._v("查询")])],1),t._v(" "),a("div",[a("br"),t._v("\n    诱捕器总数:"+t._s(t.totalCount)+"      总诱虫量 "+t._s(t.totalSum)+"\n    "),a("br")]),t._v(" "),a("el-tabs",{attrs:{id:"statistics-tabs",type:"card"},model:{value:t.tabPage,callback:function(e){t.tabPage=e},expression:"tabPage"}},[this.$store.state.user.role<4?a("el-card",{staticStyle:{padding:"5px"},attrs:{header:"各"+t.contentLabelDict[t.contentLabelIndex]+"诱捕情况表"}},[a("el-table",{attrs:{data:t.summaryDeviceData.list,"row-style":t.tableRowStyle}},[a("el-table-column",{attrs:{label:t.contentLabelDict[t.contentLabelIndex],prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"诱捕器总数",prop:"deviceCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"总诱虫量",prop:"beetleCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.showMaintenanceView(e.row.name)}}},[t._v("查看")])]}}])})],1)],1):t._e(),t._v(" "),this.$store.state.user.role>3?a("el-card",{staticStyle:{padding:"5px"},attrs:{header:"各工人诱捕情况表"}},[a("el-table",{attrs:{data:t.summaryWorkerData.list,"row-style":t.tableRowStyle}},[a("el-table-column",{attrs:{label:"工人",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"诱捕器总数",prop:"deviceCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"总诱虫量",prop:"beetleCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.showMaintenanceView(e.row.name)}}},[t._v("查看")])]}}])})],1)],1):t._e(),t._v(" "),3==this.$store.state.user.role?a("el-card",{staticStyle:{padding:"5px"},attrs:{header:"各管理员诱捕情况表"}},[a("el-table",{attrs:{data:t.summaryManagerData.list,"row-style":t.tableRowStyle}},[a("el-table-column",{attrs:{label:"管理员",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"诱捕器总数",prop:"deviceCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"总诱虫量",prop:"beetleCount"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.showMaintenanceView(e.row.name)}}},[t._v("查看")])]}}])})],1)],1):t._e()],1),t._v(" "),a("el-dialog",{attrs:{title:"设备维护信息",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("t-maintenance-data",{ref:"maintenanceView"})],1)],1)},staticRenderFns:[]};var _t=a("VU/8")(Dt,yt,!1,function(t){a("pmNj")},null,null).exports,wt={data:function(){return{username:"",deviceID:"",startDate:"",endDate:"",maintenanceData:{list:[]},date:"",num:0,batch:0,working_content:"",contentLabelIndex:0,drug:"",receveData:[],receveDataContent:[],workingContentDict:["首次悬挂诱捕器","换药+收虫","收虫","其他"]}},methods:{init:function(){this.deviceID=sessionStorage.getItem("deviceID"),this.username=sessionStorage.getItem("username"),this.startDate=sessionStorage.getItem("startDate"),this.endDate=sessionStorage.getItem("endDate"),this.loadMaintenanceData()},returnlast:function(){this.$router.push({path:"/pages/device_maintenance.html"})},loadMaintenanceData:function(){var t=this;x.requestWithToken("/auth_api/maintenance/byDeviceId","get",{deviceId:this.deviceID,myusername:this.username,endDate:this.endDate,startDate:this.startDate},function(e){e.data.error?t.$message({message:"失败",type:"error"}):(t.receveData=e.data.data,t.showList())},function(){})},showList:function(){if(this.receveData.length>0){for(var t=0;t<this.receveData.length;++t)this.contentLabelIndex=this.receveData[t].working_content,this.receveData[t].working_content=this.workingContentDict[this.contentLabelIndex];this.maintenanceData.list=this.receveData}else this.maintenanceData.list=[]}},mounted:function(){this.init()}},kt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-link",{attrs:{to:"/pages/device_summary"}},[t._v("诱捕器情况")]),t._v("\n>\n  "),a("router-link",{attrs:{to:"/pages/device_maintenance.html"}},[t._v("设备维护信息")]),t._v("\n      >诱捕器信息\n\n\n    "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.maintenanceData.list,height:"600"}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"维护批次"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"松墨天牛数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"drug",label:"诱芯类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"working_content",label:"工作内容"}})],1)],1)],1)},staticRenderFns:[]};var xt=a("VU/8")(wt,kt,!1,function(t){a("i9Tb")},null,null).exports,Ct={data:function(){return{searchText:"",searchBatch:"",searchTown:"",uploadUrl:"",otherBeetleList:[],otherBeetleDict:{},maintenanceData:{list:[],selectedIndex:-1,page:1,limit:10,total:0,startDate:"",endDate:"",selection:[],mulitpleSelection:[],multipleSelectionAll:[],triggeredByPageChange:!1,workingContentDict:["首次悬挂诱捕器","换药+收虫","收虫","其他"]},PhotoDialog:{visible:!1,pic:""},EditMaintenanceDialog:{visible:!1,form:{id:0,batch:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",altitude:"",workingContent:0,deviceId:"",drug:""}}}},methods:{handleDeleteSome:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.selection.length;++a)e.push(this.maintenanceData.selection[a].id);this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){x.requestWithTokenJson("/auth_api/maintenance/deleteSmoe","delete",{list:e},function(e){e.data.error?(t.$message.success("删除存在错误"),t.loadMaintenanceData()):(t.$message.success("删除成功"),t.loadMaintenanceData())},function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}),this.loadMaintenanceData()},handleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){x.requestWithToken("/auth_api/maintenance","delete",{id:t.id,deviceID:t.deviceId},function(t){t.data.error?e.$message({type:"error",message:"删除失败!"}):(e.loadMaintenanceData(),e.$message({type:"success",message:"删除成功!"}),e.clearMultipleSelection())},function(){})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}),this.loadMaintenanceData()},setSearchText:function(t){this.searchText=t},loadMaintenanceData:function(){var t=this;this.loadOtherBeetleType(),x.requestWithToken("/auth_api/maintenance1","get",{condition:this.searchText,batch:this.searchBatch,town:this.searchTown,page:this.maintenanceData.page,limit:this.maintenanceData.limit,startDate:this.maintenanceData.startDate,endDate:this.maintenanceData.endDate},function(e){t.maintenanceData.list=e.data.data,t.maintenanceData.total=e.data.totalNum,t.checkMultipleSelection(),t.triggeredByPageChange=!0},function(){})},clearMultipleSelection:function(){this.maintenanceData.multipleSelectionAll=[],this.maintenanceData.multipleSelection=[]},buttonLoadMaintenanceData:function(){this.maintenanceData.selection=[],this.clearMultipleSelection(),this.loadMaintenanceData()},handleMaintenanceDataCurrentPageChanged:function(t){this.triggeredByPageChange=!0,this.maintenanceData.page=t,this.loadMaintenanceData()},showPhotoDialog:function(t){this.PhotoDialog.visible=!0;this.PhotoDialog.pic="http://47.103.66.70:8081/device_img?imgName="+t},handleMaintenanceDataSelectionChange:function(t){var e=this;this.maintenanceData.selection=t,!this.triggeredByPageChange&&this.maintenanceData.page>-1&&(this.maintenanceData.mulitpleSelection[this.maintenanceData.page+""]=t,setTimeout(function(){e.calculateMultipleSelection()},500)),this.triggeredByPageChange=!1},checkMultipleSelection:function(){var t=this;this.maintenanceData.list.forEach(function(e,a){t.maintenanceData.multipleSelectionAll.indexOf(e.id)>-1&&t.$refs.table.toggleRowSelection(t.maintenanceData.list[a],!0)})},calculateMultipleSelection:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.mulitpleSelection.length;++a)null!=this.maintenanceData.mulitpleSelection[a]&&(e=e.concat(this.maintenanceData.mulitpleSelection[a]));this.maintenanceData.multipleSelectionAll=[],e.forEach(function(e){t.maintenanceData.multipleSelectionAll=t.maintenanceData.multipleSelectionAll.concat(e.id)})},showEditMaintenanceDataDialog:function(t){this.EditMaintenanceDialog.visible=!0,this.EditMaintenanceDialog.form={id:0,num:0,otherNum:0,otherType:"",longitude:"",latitude:"",batch:0,deviceId:"",workingContent:0,drug:""},this.EditMaintenanceDialog.form.longitude=t.longitude,this.EditMaintenanceDialog.form.deviceId=t.deviceId,this.EditMaintenanceDialog.form.batch=t.batch,this.EditMaintenanceDialog.form.altitude=t.altitude,this.EditMaintenanceDialog.form.latitude=t.latitude,this.EditMaintenanceDialog.form.workingContent=t.workingContent,this.EditMaintenanceDialog.form.drug=t.drug,this.EditMaintenanceDialog.form.num=t.num,this.EditMaintenanceDialog.form.id=t.id,this.EditMaintenanceDialog.form.otherNum=t.otherNum,this.EditMaintenanceDialog.form.otherType=t.otherType},handleEditMaintenanceDataSubmit:function(){var t=this;x.requestWithTokenJson("/auth_api/maintenance","put",this.EditMaintenanceDialog.form,function(e){t.$message.success("修改成功"),t.EditMaintenanceDialog.visible=!1,t.loadMaintenanceData()},function(){})},loadOtherBeetleType:function(){var t=this;x.requestWithToken("/auth_api/other_beetle","get",{},function(e){t.otherBeetleList=e.data.data;for(var a=0;a<t.otherBeetleList.length;++a)t.otherBeetleDict["t"+t.otherBeetleList[a].id]=t.otherBeetleList[a].name},function(){})},handleReportMaintenanceData:function(){for(var t=this,e=[],a=0;a<this.maintenanceData.selection.length;++a)e.push(this.maintenanceData.selection[a].id);x.requestWithTokenJson("/auth_api/maintenance/report","post",{list:e},function(e){e.data.error||(t.$message.success("上报成功"),t.loadMaintenanceData())},function(){})},someExportExcel:function(){window.location=x.getBaseUrl()+"/maintenance/export?startDate="+this.maintenanceData.startDate+"&endDate="+this.maintenanceData.endDate+"&token="+sessionStorage.token},exportExcel:function(){this.buttonLoadMaintenanceData(),window.location=x.getBaseUrl()+"/maintenance/export?startDate="+this.maintenanceData.startDate+"&endDate="+this.maintenanceData.endDate+"&condition="+this.searchText+"&batch="+this.searchBatch+"&town="+this.searchTown+"&token="+sessionStorage.token},importExcel1:function(){alert("已上传，请更新"),this.loadMaintenanceData()}},mounted:function(){this.loadMaintenanceData(),this.uploadUrl=x.getBaseUrl()+"/maintenance/import1?token="+sessionStorage.token}},St={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tool-row"}},[a("div",[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"搜索"},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"批次"},model:{value:t.searchBatch,callback:function(e){t.searchBatch=e},expression:"searchBatch"}}),t._v(" "),3==this.$store.state.user.role?a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"城镇"},model:{value:t.searchTown,callback:function(e){t.searchTown=e},expression:"searchTown"}}):t._e(),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"起始日期"},model:{value:t.maintenanceData.startDate,callback:function(e){t.$set(t.maintenanceData,"startDate",e)},expression:"maintenanceData.startDate"}}),t._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"终止日期"},model:{value:t.maintenanceData.endDate,callback:function(e){t.$set(t.maintenanceData,"endDate",e)},expression:"maintenanceData.endDate"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.buttonLoadMaintenanceData}},[t._v("搜索")])],1),t._v(" "),a("div",[3==this.$store.state.user.role?a("el-button",{attrs:{type:"primary"},on:{click:t.handleReportMaintenanceData}},[t._v("上报")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleDeleteSome}},[t._v("批量删除")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("导出")]),t._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-success":t.loadMaintenanceData}},[a("el-button",{attrs:{type:"primary"}},[t._v("点击上传")])],1)],1)]),t._v(" "),a("div",{staticStyle:{"padding-top":"5px"}},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{border:"",data:t.maintenanceData.list,height:"600"},on:{"selection-change":t.handleMaintenanceDataSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deviceId",label:"设备ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batch",label:"批次"}}),t._v(" "),a("el-table-column",{attrs:{prop:"num",label:"松墨天牛数量"}}),t._v(" "),a("el-table-column",{attrs:{label:"其他天牛类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.otherBeetleDict["t"+e.row.otherType]))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"otherNum",label:"其他天牛数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"longitude",label:"经度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"latitude",label:"纬度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"altitude",label:"海拔"}}),t._v(" "),a("el-table-column",{attrs:{label:"位置",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.province+e.row.city+e.row.area+e.row.town))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{label:"工作内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.maintenanceData.workingContentDict[e.row.workingContent]))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"drug",label:"药剂类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{label:"是否上报"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.reported?"是":"否"))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"现场照片",width:"100px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!=e.row.imageId&&""!=e.row.imageId?a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.showPhotoDialog(e.row.imageId)}}},[t._v("显示")]):t._e()]}}])}),t._v(" "),3==this.$store.state.user.role||4==this.$store.state.user.role?a("el-table-column",{attrs:{label:"操作",align:"center",width:"150px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.reported?t._e():a("div",[e.row.reported?t._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.showEditMaintenanceDataDialog(e.row)}}},[t._v("编辑")]),t._v(" "),e.row.reported?t._e():a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])],1),t._v(" "),e.row.reported?a("div",[t._v("不可操作")]):t._e()]}}])}):t._e()],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":t.maintenanceData.page,"page-size":10,layout:"total, prev, pager, next",total:t.maintenanceData.total},on:{"current-change":t.handleMaintenanceDataCurrentPageChanged,"update:currentPage":function(e){t.$set(t.maintenanceData,"page",e)}}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"现场照片",visible:t.PhotoDialog.visible,width:"700px"},on:{"update:visible":function(e){t.$set(t.PhotoDialog,"visible",e)}}},[a("div",{staticStyle:{"overflow-y":"scroll",height:"300px"}},[a("img",{staticStyle:{width:"600px"},attrs:{src:t.PhotoDialog.pic}})])]),t._v(" "),a("el-dialog",{attrs:{title:"编辑维护信息",visible:t.EditMaintenanceDialog.visible,width:"30%"},on:{"update:visible":function(e){t.$set(t.EditMaintenanceDialog,"visible",e)}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"松墨天牛数量"}},[a("el-input-number",{attrs:{min:0},model:{value:t.EditMaintenanceDialog.form.num,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"num",e)},expression:"EditMaintenanceDialog.form.num"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"经度"}},[a("el-input",{model:{value:t.EditMaintenanceDialog.form.longitude,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"longitude",e)},expression:"EditMaintenanceDialog.form.longitude"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"纬度"}},[a("el-input",{model:{value:t.EditMaintenanceDialog.form.latitude,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"latitude",e)},expression:"EditMaintenanceDialog.form.latitude"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"海拔"}},[a("el-input",{model:{value:t.EditMaintenanceDialog.form.altitude,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"altitude",e)},expression:"EditMaintenanceDialog.form.altitude"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"其他天牛类型"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.otherType,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"otherType",e)},expression:"EditMaintenanceDialog.form.otherType"}},[a("el-option",{key:t.无,attrs:{label:t.无,value:""}},[t._v("无")]),t._v(" "),t._l(t.otherBeetleList,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"其他天牛数量"}},[a("el-input-number",{attrs:{min:0},model:{value:t.EditMaintenanceDialog.form.otherNum,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"otherNum",e)},expression:"EditMaintenanceDialog.form.otherNum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"药剂类型"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.drug,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"drug",e)},expression:"EditMaintenanceDialog.form.drug"}},[a("el-option",{attrs:{label:"APF-I持久增强型",value:"APF-I持久增强型"}},[t._v("APF-I持久增强型")]),t._v(" "),a("el-option",{attrs:{label:"APF-I持久型",value:"APF-I持久型"}},[t._v("APF-I持久型")]),t._v(" "),a("el-option",{attrs:{label:"APF-I普通型",value:"APF-I普通型"}},[t._v("APF-I普通型")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"工作内容"}},[a("el-select",{model:{value:t.EditMaintenanceDialog.form.workingContent,callback:function(e){t.$set(t.EditMaintenanceDialog.form,"workingContent",e)},expression:"EditMaintenanceDialog.form.workingContent"}},[a("el-option",{attrs:{value:0,label:"首次悬挂诱捕器"}},[t._v("首次悬挂诱捕器")]),t._v(" "),a("el-option",{attrs:{value:1,label:"换药+收虫"}},[t._v("换药+收虫")]),t._v(" "),a("el-option",{attrs:{value:2,label:"收虫"}},[t._v("收虫")]),t._v(" "),a("el-option",{attrs:{value:3,label:"其他"}},[t._v("其他")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.EditMaintenanceDialog.visible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleEditMaintenanceDataSubmit(e)}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Lt=a("VU/8")(Ct,St,!1,function(t){a("h367")},null,null).exports;o.a.use(u.a);var $t=new u.a({routes:[{path:"/login",name:"Login",component:L},{path:"/",name:"Home",component:T,children:[{path:"/helloworld",name:"HelloWorld",component:h},{path:"pages/user_mgr.html",name:"用户管理",component:W},{path:"pages/device_wanted2.html",name:"数据修改",component:Lt},{path:"pages/map_statistics.html",name:"地图数据分析",component:G},{path:"pages/device_summary",name:"诱捕器情况",component:_t,meta:{keepAlive:!0}},{path:"/pages/device_wanted1.html",name:"数据修改上报",component:Lt,meta:{keepAlive:!0}},{path:"pages/device_message",name:"诱捕器信息",component:xt},{path:"pages/device_maintenance.html",name:"设备维护信息",component:ot},{path:"pages/device_map.html",name:"地图",component:tt},{path:"pages/qrcode_mgr.html",name:"二维码管理",component:it},{path:"pages/device_maintenance_abnormal.html",name:"设备异常维护信息",component:ct},{path:"pages/statistics.html",name:"数据分析",component:ht},{path:"pages/other_beetle",name:"其他天牛命名",component:vt},{path:"pages/other_beetleroot",name:"其他天牛配置",component:vt},{path:"pages/weather_info",name:"气象信息",component:bt},{path:"pages/month_summary",name:"时间动态",component:U}]}],linkActiveClass:"active-router",linkExactActiveClass:"exact-router"}),Mt=(a("tvR6"),a("e0XP"),a("l6IN"));o.a.use(Mt.Pagination),o.a.use(Mt.Dialog),o.a.use(Mt.Dropdown),o.a.use(Mt.DropdownMenu),o.a.use(Mt.DropdownItem),o.a.use(Mt.Menu),o.a.use(Mt.Submenu),o.a.use(Mt.MenuItem),o.a.use(Mt.MenuItemGroup),o.a.use(Mt.Input),o.a.use(Mt.InputNumber),o.a.use(Mt.Radio),o.a.use(Mt.RadioGroup),o.a.use(Mt.RadioButton),o.a.use(Mt.Checkbox),o.a.use(Mt.CheckboxButton),o.a.use(Mt.CheckboxGroup),o.a.use(Mt.Switch),o.a.use(Mt.Select),o.a.use(Mt.Option),o.a.use(Mt.OptionGroup),o.a.use(Mt.Button),o.a.use(Mt.ButtonGroup),o.a.use(Mt.Table),o.a.use(Mt.TableColumn),o.a.use(Mt.DatePicker),o.a.use(Mt.Popover),o.a.use(Mt.Tooltip),o.a.use(Mt.Breadcrumb),o.a.use(Mt.BreadcrumbItem),o.a.use(Mt.Form),o.a.use(Mt.FormItem),o.a.use(Mt.Tabs),o.a.use(Mt.TabPane),o.a.use(Mt.Tag),o.a.use(Mt.Alert),o.a.use(Mt.Icon),o.a.use(Mt.Row),o.a.use(Mt.Col),o.a.use(Mt.Badge),o.a.use(Mt.Card),o.a.use(Mt.Steps),o.a.use(Mt.Step),o.a.use(Mt.Carousel),o.a.use(Mt.CarouselItem),o.a.use(Mt.Collapse),o.a.use(Mt.CollapseItem),o.a.use(Mt.Cascader),o.a.use(Mt.ColorPicker),o.a.use(Mt.Transfer),o.a.use(Mt.Container),o.a.use(Mt.Header),o.a.use(Mt.Aside),o.a.use(Mt.Main),o.a.use(Mt.Footer),o.a.use(Mt.Loading.directive),o.a.prototype.$loading=Mt.Loading.service,o.a.prototype.$msgbox=Mt.MessageBox,o.a.prototype.$alert=Mt.MessageBox.alert,o.a.prototype.$confirm=Mt.MessageBox.confirm,o.a.prototype.$prompt=Mt.MessageBox.prompt,o.a.prototype.$notify=Mt.Notification,o.a.prototype.$message=Mt.Message,o.a.config.productionTip=!1,o.a.use(r.a);var Tt=new r.a.Store({state:{user:{username:""}}});e.default=Tt;new o.a({el:"#app",router:$t,store:Tt,components:{App:c},template:"<App/>"})},NSnf:function(t,e){},Pg0u:function(t,e){t.exports=echarts},V9T7:function(t,e){},e0XP:function(t,e){},h367:function(t,e){},i9Tb:function(t,e){},j998:function(t,e){},jBV8:function(t,e){},l6IN:function(t,e){t.exports=ELEMENT},lRwf:function(t,e){t.exports=Vue},oXj8:function(t,e){},pmNj:function(t,e){},tvR6:function(t,e){},xJpQ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.237622a6fbea96708d5d.js.map